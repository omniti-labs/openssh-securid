This patch from Theo Schlossnagle <jesus@omniti.com> adds SecurID
authentication support to portable OpenSSH. To apply, run the following
command from the source directory:

patch -p1 < contrib/SecurID.diff

You will need to re-run 'configure' if you have not already done so. Please
refer to the README.SecurID (which will be created by the above command) for
more information.

The homepage for the latest version of this patch is:

http://www.omniti.com/~jesus/projects/

Please refer to the homepage first if you have any problems.

diff -ruN openssh-2.9p2.orig/Makefile.in openssh-2.9p2/Makefile.in
--- openssh-2.9p2.orig/Makefile.in	Thu Apr 26 20:31:08 2001
+++ openssh-2.9p2/Makefile.in	Thu Jun 28 13:03:54 2001
@@ -49,7 +49,7 @@
 
 SSHOBJS= ssh.o sshconnect.o sshconnect1.o sshconnect2.o sshtty.o readconf.o clientloop.o
 
-SSHDOBJS= sshd.o auth.o auth1.o auth2.o auth-chall.o auth2-chall.o auth-rhosts.o auth-options.o auth-krb4.o auth-pam.o auth2-pam.o auth-passwd.o auth-rsa.o auth-rh-rsa.o auth-sia.o sshpty.o sshlogin.o loginrec.o servconf.o serverloop.o md5crypt.o session.o groupaccess.o
+SSHDOBJS= sshd.o auth.o auth1.o auth2.o auth-chall.o auth2-chall.o auth-rhosts.o auth-options.o auth-krb4.o auth-pam.o auth2-pam.o auth-passwd.o auth-rsa.o auth-rh-rsa.o auth-securid.o auth-sia.o sshpty.o sshlogin.o loginrec.o servconf.o serverloop.o md5crypt.o session.o groupaccess.o
 
 MANPAGES	= scp.1.out ssh-add.1.out ssh-agent.1.out ssh-keygen.1.out ssh-keyscan.1.out ssh.1.out sshd.8.out sftp-server.8.out sftp.1.out
 MANPAGES_IN	= scp.1 ssh-add.1 ssh-agent.1 ssh-keygen.1 ssh-keyscan.1 ssh.1 sshd.8 sftp-server.8 sftp.1
diff -ruN openssh-2.9p2.orig/README.SecurID openssh-2.9p2/README.SecurID
--- openssh-2.9p2.orig/README.SecurID	Wed Dec 31 19:00:00 1969
+++ openssh-2.9p2/README.SecurID	Thu Jun 28 13:13:50 2001
@@ -0,0 +1,94 @@
+/*
+ * Author: Theo Schlossnagle <jesus@omniti.com>
+ * Copyright (c) 2000,2001 Theo Schlossnagle <jesus@omniti.com>
+ *                    All rights reserved
+ * Created: September 21, 2000
+ * License: OpenSSH License.  See the license for OpenSSH for more details.
+ *
+ * June 28, 2001:
+ * Updated to 2.9p2 -- jesus@omniti.com
+ * no new features
+ *
+ * April 24, 2001:
+ * Updated to 2.9p1 -- jesus@omniti.com
+ * added autoconf clauses to fault if sdiclient.a and headers aren't there.
+ *
+ * April 21, 2001:
+ * Updated to 2.5.2p2 -- jesus@omniti.com
+ * Incorporated some bug fixes from Anders Olsen to fix next-token code.
+ *
+ * March 19, 2001:
+ * Updated to 2.5.2p1 -- jesus@omniti.com
+ *
+ * December 20, 2000:
+ * Updated to 2.3.0p1 -- jesus@omniti.com
+ *
+ * Jan 9th, 2001:
+ * Added SecurIDUsersFile, SecurIDIgnoreShell, AllowNonSecurID directives
+ * to the sshd_config file.  These parameters are documented in the man page.
+ * This provides a more logical seperationg between fail-through due to system
+ * failure and fall-through by configuration. (fall-through vs. fail-through)
+ *   -- jesus@omniti.com
+ */
+
+Seems like a few people are interested.  So here is the patch.
+
+This has only been tested on UNICIES that support PAM.  There is untested
+(only 5 lines) code in auth-passwd.c that should provide the same
+functionality for normal (non-PAM) password verifications.
+
+The patch is logical quite small, the physical patch bulky because it contains
+all the line number changes in "configure" after running autoconf on the
+modified configure.in file (in which I changed maybe 10 lines -- Yuk.)
+
+The sshd man page has been patched too :-)  Read it for the two new options
+relating to SecurID.
+
+How it works:
+
+0) apply patch ;-)
+1) copy sdi headers (in SecurID example directory) into either a standard
+include place (like /usr/local/include) or into the openssh source tree
+or add the --with-cflags=-I/path/to/ace/examples (where the include files are)
+2) copy the sdiclient.a file (same dir) into the openssh source tree.
+
+Make sure that /var/ace contains your sdconf.rec, etc.  If you installed
+SecurID client or server on a machine it should be this way already.  If you
+used a non-standard install location do a "ln -s /path/to/ace/data /var/ace"
+
+3) add --with-securid --with-pam to the configure flags.  This module rides on
+the PAM authentication mechanism.
+
+It will trigger if a user has a shell in /etc/passwd that ends with "sdshell"
+and it snags your shell the same way sdshell does.  Users with other shells
+will log in as if SecurID didn't exist.
+
+Done:
+  o Normal passcode verification
+  o Enter next token for verification
+    (use ssh -v to see the *useful* debgging messages)
+
+ssh -v will let you know if:
+ o your code was accepted.
+ o your code was rejected.
+ o you are required to wait for the next token and enter that.
+
+TODO:
+  o Handle PIN creation and changing (as their are by default three log in
+attempts, it should be straight forward to integrate in these additions --
+both of these operations require exactly three user inputs.)
+  o Add sshd_config parameter to specify the VAR_ACE location (forced to
+/var/ace OR VAR_ACE environment variable now.)
+  o Make autoconf find the headers in logical places and add a long-option to
+give it a hint.  I am an "autoconf idiot"... The small changes I made were
+challenging enough :) 
+
+
+DISCLAIMER:
+  I works for me (yes, in production).  If you get locked out of a production
+system becuase you replaced your sshd with this one, feeling really dumb is
+YOUR responsibility NOT mine.  It is not my fault :-D
+
+Hope this is useful! scp (and all other tools that can use ssh like rsync and
+cvs) will work now!!!! Hooray!
+
diff -ruN openssh-2.9p2.orig/acconfig.h openssh-2.9p2/acconfig.h
--- openssh-2.9p2.orig/acconfig.h	Tue May  8 16:34:32 2001
+++ openssh-2.9p2/acconfig.h	Thu Jun 28 13:03:54 2001
@@ -193,6 +193,9 @@
 /* Define if you want S/Key support */
 #undef SKEY
 
+/* Define if you want SecurID support */
+#undef SECURID
+
 /* Define if you want TCP Wrappers support */
 #undef LIBWRAP
 
diff -ruN openssh-2.9p2.orig/auth-pam.c openssh-2.9p2/auth-pam.c
--- openssh-2.9p2.orig/auth-pam.c	Mon Apr 23 14:38:37 2001
+++ openssh-2.9p2/auth-pam.c	Thu Jun 28 13:03:54 2001
@@ -170,7 +170,6 @@
 
 	return PAM_SUCCESS;
 }
-
 /* Called at exit to cleanly shutdown PAM */
 void do_pam_cleanup_proc(void *context)
 {
@@ -213,7 +212,19 @@
 		return 0;
 	if (*password == '\0' && options.permit_empty_passwd == 0)
 		return 0;
-
+#ifdef SECURID
+	if (options.securid_authentication == 1) {
+		int ret;
+		debug("Attempting SecurID authentication user \"%.100s\"", pw->pw_name);
+		ret = auth_securid_password(pw, password);
+		if (ret >= 0)
+			return ret;
+		/* Only returns < 0 if the account is not a SecurID account */
+		/* Fall back to ordinary passwd authentication. */
+	} else {
+		debug("SecurID disabled in server config.  Using PAM.");
+	}
+#endif
 	__pampasswd = password;
 
 	pamstate = INITIAL_LOGIN;
diff -ruN openssh-2.9p2.orig/auth-passwd.c openssh-2.9p2/auth-passwd.c
--- openssh-2.9p2.orig/auth-passwd.c	Wed Apr 25 08:50:19 2001
+++ openssh-2.9p2/auth-passwd.c	Thu Jun 28 13:03:54 2001
@@ -147,6 +147,15 @@
 	}
 #endif
 
+#ifdef SECURID
+	if (options.securid_authentication == 1) {
+		int ret = auth_securid_password(pw, password);
+		if (ret >= 0)
+			return ret;
+		/* Only returns < 0 if the account is not a SecurID account */
+		/* Fall back to ordinary passwd authentication. */
+	}
+#endif
 #ifdef WITH_AIXAUTHENTICATE
 	return (authenticate(pw->pw_name,password,&reenter,&authmsg) == 0);
 #endif
diff -ruN openssh-2.9p2.orig/auth-securid.c openssh-2.9p2/auth-securid.c
--- openssh-2.9p2.orig/auth-securid.c	Wed Dec 31 19:00:00 1969
+++ openssh-2.9p2/auth-securid.c	Thu Jun 28 13:03:54 2001
@@ -0,0 +1,189 @@
+/*
+ * Author: Theo Schlossnagle <jesus@omniti.com>
+ * Copyright (c) 2000 Theo Schlossnagle <jesus@omniti.com>
+ *                    All rights reserved
+ * Created: September 21, 2000
+ * This file contains the code to process a SecurID authentication
+ * including the "next token" request.
+ */
+
+#include "includes.h"
+
+RCSID("$OpenBSD: auth-securid.c,v 1.0 2000/09/21 01:39:38 jesus Exp $");
+
+#include "packet.h"
+#include "ssh.h"
+#include "log.h"
+#include "servconf.h"
+#include "xmalloc.h"
+
+#ifdef WITH_AIXAUTHENTICATE
+# include <login.h>
+#endif
+#ifdef HAVE_HPUX_TRUSTED_SYSTEM_PW
+# include <hpsecurity.h>
+# include <prot.h>
+#endif
+#ifdef HAVE_SHADOW_H
+# include <shadow.h>
+#endif
+#ifdef HAVE_GETPWANAM
+# include <sys/label.h>
+# include <sys/audit.h>
+# include <pwdadj.h>
+#endif
+#if defined(HAVE_MD5_PASSWORDS) && !defined(HAVE_MD5_CRYPT)
+# include "md5crypt.h"
+#endif /* defined(HAVE_MD5_PASSWORDS) && !defined(HAVE_MD5_CRYPT) */
+
+#ifdef SECURID
+#include "sdi_athd.h"
+#include "sdconf.h"
+#include "sdacmvls.h"
+
+union config_record configure;
+#endif
+
+/*
+ * Tries to authenticate the user using password.  Returns true if
+ * authentication succeeds.
+ */
+#define INBUFFLEN 256
+
+int
+securid_usersfile_find(const char *pw_name)
+{
+	extern ServerOptions options;
+	FILE *inf;
+	char inbuff[INBUFFLEN];
+	struct stat fileinfo;
+	int retval = 0;
+
+	if(!options.securid_usersfile) {
+		error("In securid_usersfile_find() with NULL filename!");
+		return -1;
+	}
+	if(lstat(options.securid_usersfile, &fileinfo)) {
+		error("Cannot open %s: %s",
+		      options.securid_usersfile, strerror(errno));
+		return -1;
+	}
+	if(fileinfo.st_mode & (S_IWOTH|S_IWGRP)) {
+		error("SecurIDUsersFile is writeable by group and other");
+		return -1;
+	}
+	if(!(inf = fopen(options.securid_usersfile, "r"))) {
+		error("Cannot open %s: %s",
+		      options.securid_usersfile, strerror(errno));
+		return -1;
+	}
+	while(fgets(inbuff,INBUFFLEN-1,inf) != NULL) {
+		if(inbuff[strlen(inbuff) - 1] == '\n')
+			inbuff[strlen(inbuff) - 1] = '\0';
+		retval = !strcmp(inbuff,pw_name);
+		if(retval) break;
+        }
+	fclose(inf);
+	if(retval) return 1;
+	debug2("Failed to find %s in %s",
+		pw_name, options.securid_usersfile);
+	return 0;
+}
+int
+auth_securid_password(struct passwd * pw, const char *password)
+{
+	static int state = 0;	/* This tells us where we expect a
+					0 "PIN"
+					1 "Next Token"
+				*/
+	int doauth;
+	char *ecp;
+	extern ServerOptions options;
+#ifndef SECURID
+	return -1;
+#else
+	/* Add static for the nexttoken case -- Anders Olsen 20010409 */
+	static struct SD_CLIENT sd_dat, *sd;
+
+	/* Check for users with no sdshell and pass them by. */
+	if(options.securid_usersfile) {
+		doauth = securid_usersfile_find(pw->pw_name);
+		if(doauth == 0) {	/* file is there, user is not */
+			if(options.allow_nonsecurid) return -1;
+			return 0;
+		} else if(doauth < 0) { /* File not there or bad perms! */
+			error("Failing SecurID login attempt");
+			return 0;	/* Fail */
+		}
+	} else {
+		/* No users securid_usersfile
+		   so use shells that end in sdshell */
+		if (!((ecp = strstr(pw->pw_shell, "sdshell")) &&
+				(*(ecp+8)=='\0')))
+			if(options.allow_nonsecurid) return -1;
+		else
+			return 0;
+	}
+	/* sd_check on with an empty password causes segfault against some
+		versions of sdiclient -- Anders Olsen 20010409 */
+	if (*password == '\0') {
+		debug2("auth_securid_password: empty password, skipping");
+		return 0;
+	}
+	/* Don't reopen session to securid-server is nexttoken
+		-- Adres Olsen 20010410 */
+	if (state == 0) {
+		int ret;
+		memset(&sd_dat, 0, sizeof(sd_dat));   /* clear struct */
+		sd = &sd_dat;
+
+		if(creadcfg()) {
+			/* Can't read sdconf.rec!  Gotta bail */
+			packet_send_debug("Couldn't read sdconf.rec.");
+			if(options.securid_fallback) return -1;
+			return 0;
+		}
+		if(sd_init(sd)) {
+			/* Can't establish client/server comms!  Gotta bail */
+			packet_send_debug("Couldn't establish client/server communications.");
+			if(options.securid_fallback) return -1;
+			return 0;
+		}
+		/* Auth PIN... */
+		ret = sd_check(password, pw->pw_name, sd);
+		if(ret == ACM_OK) {
+			goto success;
+		}
+		if(ret == ACM_ACCESS_DENIED) {
+			packet_send_debug("SecurID passcode rejected.");
+			return 0; /* Failed! */
+		}
+		if(ret == ACM_NEXT_CODE_REQUIRED) {
+			packet_send_debug("SecurID needs next token.");
+			state = 1; /* Process next try as sd_next */
+			return 0;  /* Fail, so ssh will prmpt again */
+		}
+	} else {
+		/* Auth next token... */
+		int ret;
+		state = 0;  /* Set back to PIN mode */
+		ret = sd_next(password, sd);
+		if(ret == ACM_OK) {
+			goto success;
+		}
+		packet_send_debug("SecurID passcode rejected.");
+		return 0; /* Failed */
+	}
+	packet_send_debug("Unhandled sdcheck() return code.");
+	return 0; /* Failed! */
+
+success:
+	/* We don't free pw->pw_shell here, becuase we don't know how it was
+	   allocated... Besides it is a very small, one-time leak if we did
+	   need to free it. */
+	if(!options.securid_ignore_shell)
+		pw->pw_shell = strdup(sd->shell);
+	packet_send_debug("SecurID passcode accepted.");
+	return 1; /* Success */
+#endif
+}
diff -ruN openssh-2.9p2.orig/config.h.in openssh-2.9p2/config.h.in
--- openssh-2.9p2.orig/config.h.in	Sun Jun 17 00:09:47 2001
+++ openssh-2.9p2/config.h.in	Thu Jun 28 13:03:54 2001
@@ -199,6 +199,9 @@
 /* Define if you want S/Key support */
 #undef SKEY
 
+/* Define if you want SecurID support */
+#undef SECURID
+
 /* Define if you want TCP Wrappers support */
 #undef LIBWRAP
 
diff -ruN openssh-2.9p2.orig/configure openssh-2.9p2/configure
--- openssh-2.9p2.orig/configure	Sun Jun 17 00:09:50 2001
+++ openssh-2.9p2/configure	Thu Jun 28 13:04:23 2001
@@ -26,6 +26,8 @@
 ac_help="$ac_help
   --with-skey=PATH         Enable S/Key support"
 ac_help="$ac_help
+  --with-securid          Enable SecurID support"
+ac_help="$ac_help
   --with-tcp-wrappers     Enable tcpwrappers support"
 ac_help="$ac_help
   --with-pam              Enable PAM support "
@@ -601,7 +603,7 @@
 # Extract the first word of "gcc", so it can be a program name with args.
 set dummy gcc; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:605: checking for $ac_word" >&5
+echo "configure:607: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -631,7 +633,7 @@
   # Extract the first word of "cc", so it can be a program name with args.
 set dummy cc; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:635: checking for $ac_word" >&5
+echo "configure:637: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -682,7 +684,7 @@
       # Extract the first word of "cl", so it can be a program name with args.
 set dummy cl; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:686: checking for $ac_word" >&5
+echo "configure:688: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -714,7 +716,7 @@
 fi
 
 echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
-echo "configure:718: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
+echo "configure:720: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
 
 ac_ext=c
 # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
@@ -725,12 +727,12 @@
 
 cat > conftest.$ac_ext << EOF
 
-#line 729 "configure"
+#line 731 "configure"
 #include "confdefs.h"
 
 main(){return(0);}
 EOF
-if { (eval echo configure:734: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:736: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   ac_cv_prog_cc_works=yes
   # If we can't run a trivial program, we are probably using a cross compiler.
   if (./conftest; exit) 2>/dev/null; then
@@ -756,12 +758,12 @@
   { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
 fi
 echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
-echo "configure:760: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
+echo "configure:762: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
 echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
 cross_compiling=$ac_cv_prog_cc_cross
 
 echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
-echo "configure:765: checking whether we are using GNU C" >&5
+echo "configure:767: checking whether we are using GNU C" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -770,7 +772,7 @@
   yes;
 #endif
 EOF
-if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:774: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:776: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
   ac_cv_prog_gcc=yes
 else
   ac_cv_prog_gcc=no
@@ -789,7 +791,7 @@
 ac_save_CFLAGS="$CFLAGS"
 CFLAGS=
 echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
-echo "configure:793: checking whether ${CC-cc} accepts -g" >&5
+echo "configure:795: checking whether ${CC-cc} accepts -g" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -846,7 +848,7 @@
 fi
 
 echo $ac_n "checking host system type""... $ac_c" 1>&6
-echo "configure:850: checking host system type" >&5
+echo "configure:852: checking host system type" >&5
 
 host_alias=$host
 case "$host_alias" in
@@ -867,14 +869,14 @@
 echo "$ac_t""$host" 1>&6
 
 echo $ac_n "checking whether byte ordering is bigendian""... $ac_c" 1>&6
-echo "configure:871: checking whether byte ordering is bigendian" >&5
+echo "configure:873: checking whether byte ordering is bigendian" >&5
 if eval "test \"`echo '$''{'ac_cv_c_bigendian'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   ac_cv_c_bigendian=unknown
 # See if sys/param.h defines the BYTE_ORDER macro.
 cat > conftest.$ac_ext <<EOF
-#line 878 "configure"
+#line 880 "configure"
 #include "confdefs.h"
 #include <sys/types.h>
 #include <sys/param.h>
@@ -885,11 +887,11 @@
 #endif
 ; return 0; }
 EOF
-if { (eval echo configure:889: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:891: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   # It does; now see whether it defined to BIG_ENDIAN or not.
 cat > conftest.$ac_ext <<EOF
-#line 893 "configure"
+#line 895 "configure"
 #include "confdefs.h"
 #include <sys/types.h>
 #include <sys/param.h>
@@ -900,7 +902,7 @@
 #endif
 ; return 0; }
 EOF
-if { (eval echo configure:904: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:906: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   ac_cv_c_bigendian=yes
 else
@@ -920,7 +922,7 @@
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 924 "configure"
+#line 926 "configure"
 #include "confdefs.h"
 main () {
   /* Are we little or big endian?  From Harbison&Steele.  */
@@ -933,7 +935,7 @@
   exit (u.c[sizeof (long) - 1] == 1);
 }
 EOF
-if { (eval echo configure:937: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:939: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_c_bigendian=no
 else
@@ -959,7 +961,7 @@
 
 # Checks for programs.
 echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
-echo "configure:963: checking how to run the C preprocessor" >&5
+echo "configure:965: checking how to run the C preprocessor" >&5
 # On Suns, sometimes $CPP names a directory.
 if test -n "$CPP" && test -d "$CPP"; then
   CPP=
@@ -974,13 +976,13 @@
   # On the NeXT, cc -E runs the code through the compiler's parser,
   # not just through cpp.
   cat > conftest.$ac_ext <<EOF
-#line 978 "configure"
+#line 980 "configure"
 #include "confdefs.h"
 #include <assert.h>
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:984: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:986: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   :
@@ -991,13 +993,13 @@
   rm -rf conftest*
   CPP="${CC-cc} -E -traditional-cpp"
   cat > conftest.$ac_ext <<EOF
-#line 995 "configure"
+#line 997 "configure"
 #include "confdefs.h"
 #include <assert.h>
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1001: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1003: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   :
@@ -1008,13 +1010,13 @@
   rm -rf conftest*
   CPP="${CC-cc} -nologo -E"
   cat > conftest.$ac_ext <<EOF
-#line 1012 "configure"
+#line 1014 "configure"
 #include "confdefs.h"
 #include <assert.h>
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1018: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1020: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   :
@@ -1041,7 +1043,7 @@
 # Extract the first word of "ranlib", so it can be a program name with args.
 set dummy ranlib; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1045: checking for $ac_word" >&5
+echo "configure:1047: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1080,7 +1082,7 @@
 # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
 # ./install, which can be erroneously created by make from ./install.sh.
 echo $ac_n "checking for a BSD compatible install""... $ac_c" 1>&6
-echo "configure:1084: checking for a BSD compatible install" >&5
+echo "configure:1086: checking for a BSD compatible install" >&5
 if test -z "$INSTALL"; then
 if eval "test \"`echo '$''{'ac_cv_path_install'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -1135,7 +1137,7 @@
 # Extract the first word of "ar", so it can be a program name with args.
 set dummy ar; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1139: checking for $ac_word" >&5
+echo "configure:1141: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_AR'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1172,7 +1174,7 @@
 # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1176: checking for $ac_word" >&5
+echo "configure:1178: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PERL'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1211,7 +1213,7 @@
 # Extract the first word of "ent", so it can be a program name with args.
 set dummy ent; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1215: checking for $ac_word" >&5
+echo "configure:1217: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_ENT'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1249,7 +1251,7 @@
 # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1253: checking for $ac_word" >&5
+echo "configure:1255: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_FILEPRIV'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1288,7 +1290,7 @@
 # Extract the first word of "bash", so it can be a program name with args.
 set dummy bash; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1292: checking for $ac_word" >&5
+echo "configure:1294: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_TEST_MINUS_S_SH'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1323,7 +1325,7 @@
 # Extract the first word of "ksh", so it can be a program name with args.
 set dummy ksh; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1327: checking for $ac_word" >&5
+echo "configure:1329: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_TEST_MINUS_S_SH'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1358,7 +1360,7 @@
 # Extract the first word of "sh", so it can be a program name with args.
 set dummy sh; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1362: checking for $ac_word" >&5
+echo "configure:1364: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_TEST_MINUS_S_SH'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1406,7 +1408,7 @@
 	# Extract the first word of "login", so it can be a program name with args.
 set dummy login; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1410: checking for $ac_word" >&5
+echo "configure:1412: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_LOGIN_PROGRAM_FALLBACK'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1453,21 +1455,21 @@
 	
 # C Compiler features
 echo $ac_n "checking for inline""... $ac_c" 1>&6
-echo "configure:1457: checking for inline" >&5
+echo "configure:1459: checking for inline" >&5
 if eval "test \"`echo '$''{'ac_cv_c_inline'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   ac_cv_c_inline=no
 for ac_kw in inline __inline__ __inline; do
   cat > conftest.$ac_ext <<EOF
-#line 1464 "configure"
+#line 1466 "configure"
 #include "confdefs.h"
 
 int main() {
 } $ac_kw foo() {
 ; return 0; }
 EOF
-if { (eval echo configure:1471: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:1473: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   ac_cv_c_inline=$ac_kw; break
 else
@@ -1506,12 +1508,12 @@
 		blibpath="/usr/lib:/lib:/usr/local/lib"
 	fi
 	echo $ac_n "checking for authenticate""... $ac_c" 1>&6
-echo "configure:1510: checking for authenticate" >&5
+echo "configure:1512: checking for authenticate" >&5
 if eval "test \"`echo '$''{'ac_cv_func_authenticate'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1515 "configure"
+#line 1517 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char authenticate(); below.  */
@@ -1534,7 +1536,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:1538: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1540: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_authenticate=yes"
 else
@@ -1673,12 +1675,12 @@
 EOF
 
 	echo $ac_n "checking for jlimit_startjob""... $ac_c" 1>&6
-echo "configure:1677: checking for jlimit_startjob" >&5
+echo "configure:1679: checking for jlimit_startjob" >&5
 if eval "test \"`echo '$''{'ac_cv_func_jlimit_startjob'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1682 "configure"
+#line 1684 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char jlimit_startjob(); below.  */
@@ -1701,7 +1703,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:1705: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1707: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_jlimit_startjob=yes"
 else
@@ -1750,7 +1752,7 @@
 
 	SONY=1
 	echo $ac_n "checking for xatexit in -liberty""... $ac_c" 1>&6
-echo "configure:1754: checking for xatexit in -liberty" >&5
+echo "configure:1756: checking for xatexit in -liberty" >&5
 ac_lib_var=`echo iberty'_'xatexit | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -1758,7 +1760,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-liberty  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 1762 "configure"
+#line 1764 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -1769,7 +1771,7 @@
 xatexit()
 ; return 0; }
 EOF
-if { (eval echo configure:1773: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1775: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -1844,7 +1846,7 @@
 	# hardwire lastlog location (can't detect it on some versions)
 	conf_lastlog_location="/var/adm/lastlog"
 	echo $ac_n "checking for obsolete utmp and wtmp in solaris2.x""... $ac_c" 1>&6
-echo "configure:1848: checking for obsolete utmp and wtmp in solaris2.x" >&5
+echo "configure:1850: checking for obsolete utmp and wtmp in solaris2.x" >&5
 	sol2ver=`echo "$host"| sed -e 's/.*[0-9]\.//'`
 	if test "$sol2ver" -ge 8; then
 		echo "$ac_t""yes" 1>&6
@@ -1865,12 +1867,12 @@
 	for ac_func in getpwanam
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:1869: checking for $ac_func" >&5
+echo "configure:1871: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1874 "configure"
+#line 1876 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -1893,7 +1895,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:1897: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1899: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -2017,12 +2019,12 @@
 	for ac_func in getluid setluid
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:2021: checking for $ac_func" >&5
+echo "configure:2023: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2026 "configure"
+#line 2028 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -2045,7 +2047,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2049: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2051: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -2096,12 +2098,12 @@
 	for ac_func in getluid setluid
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:2100: checking for $ac_func" >&5
+echo "configure:2102: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2105 "configure"
+#line 2107 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -2124,7 +2126,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2128: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2130: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -2152,7 +2154,7 @@
 	;;
 *-dec-osf*)
 	echo $ac_n "checking for Digital Unix SIA""... $ac_c" 1>&6
-echo "configure:2156: checking for Digital Unix SIA" >&5
+echo "configure:2158: checking for Digital Unix SIA" >&5
 	no_osfsia=""
 	# Check whether --with-osfsia or --without-osfsia was given.
 if test "${with_osfsia+set}" = set; then
@@ -2236,7 +2238,7 @@
   
 
 		echo $ac_n "checking for pcre_info in -lpcre""... $ac_c" 1>&6
-echo "configure:2240: checking for pcre_info in -lpcre" >&5
+echo "configure:2242: checking for pcre_info in -lpcre" >&5
 ac_lib_var=`echo pcre'_'pcre_info | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2244,7 +2246,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lpcre  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2248 "configure"
+#line 2250 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2255,7 +2257,7 @@
 pcre_info()
 ; return 0; }
 EOF
-if { (eval echo configure:2259: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2261: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2292,7 +2294,7 @@
 # Checks for libraries.
 if test -z "$no_libnsl" ; then
 	echo $ac_n "checking for yp_match in -lnsl""... $ac_c" 1>&6
-echo "configure:2296: checking for yp_match in -lnsl" >&5
+echo "configure:2298: checking for yp_match in -lnsl" >&5
 ac_lib_var=`echo nsl'_'yp_match | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2300,7 +2302,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lnsl  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2304 "configure"
+#line 2306 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2311,7 +2313,7 @@
 yp_match()
 ; return 0; }
 EOF
-if { (eval echo configure:2315: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2317: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2341,7 +2343,7 @@
 fi
 if test -z "$no_libsocket" ; then
 	echo $ac_n "checking for main in -lsocket""... $ac_c" 1>&6
-echo "configure:2345: checking for main in -lsocket" >&5
+echo "configure:2347: checking for main in -lsocket" >&5
 ac_lib_var=`echo socket'_'main | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2349,14 +2351,14 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lsocket  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2353 "configure"
+#line 2355 "configure"
 #include "confdefs.h"
 
 int main() {
 main()
 ; return 0; }
 EOF
-if { (eval echo configure:2360: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2362: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2386,7 +2388,7 @@
 fi
 
 echo $ac_n "checking for innetgr in -lrpc""... $ac_c" 1>&6
-echo "configure:2390: checking for innetgr in -lrpc" >&5
+echo "configure:2392: checking for innetgr in -lrpc" >&5
 ac_lib_var=`echo rpc'_'innetgr | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2394,7 +2396,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lrpc -lyp -lrpc $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2398 "configure"
+#line 2400 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2405,7 +2407,7 @@
 innetgr()
 ; return 0; }
 EOF
-if { (eval echo configure:2409: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2411: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2427,7 +2429,7 @@
 
 
 echo $ac_n "checking for getspnam in -lgen""... $ac_c" 1>&6
-echo "configure:2431: checking for getspnam in -lgen" >&5
+echo "configure:2433: checking for getspnam in -lgen" >&5
 ac_lib_var=`echo gen'_'getspnam | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2435,7 +2437,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lgen  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2439 "configure"
+#line 2441 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2446,7 +2448,7 @@
 getspnam()
 ; return 0; }
 EOF
-if { (eval echo configure:2450: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2452: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2467,7 +2469,7 @@
 fi
 
 echo $ac_n "checking for deflate in -lz""... $ac_c" 1>&6
-echo "configure:2471: checking for deflate in -lz" >&5
+echo "configure:2473: checking for deflate in -lz" >&5
 ac_lib_var=`echo z'_'deflate | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2475,7 +2477,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lz  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2479 "configure"
+#line 2481 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2486,7 +2488,7 @@
 deflate()
 ; return 0; }
 EOF
-if { (eval echo configure:2490: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2492: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2515,7 +2517,7 @@
 fi
 
 echo $ac_n "checking for login in -lutil""... $ac_c" 1>&6
-echo "configure:2519: checking for login in -lutil" >&5
+echo "configure:2521: checking for login in -lutil" >&5
 ac_lib_var=`echo util'_'login | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2523,7 +2525,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lutil  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2527 "configure"
+#line 2529 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2534,7 +2536,7 @@
 login()
 ; return 0; }
 EOF
-if { (eval echo configure:2538: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2540: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2561,12 +2563,12 @@
 # We don't want to check if we did an pcre override.
 if test -z "$no_comp_check" ; then
 	echo $ac_n "checking for regcomp""... $ac_c" 1>&6
-echo "configure:2565: checking for regcomp" >&5
+echo "configure:2567: checking for regcomp" >&5
 if eval "test \"`echo '$''{'ac_cv_func_regcomp'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2570 "configure"
+#line 2572 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char regcomp(); below.  */
@@ -2589,7 +2591,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2593: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2595: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_regcomp=yes"
 else
@@ -2611,7 +2613,7 @@
   echo "$ac_t""no" 1>&6
 
 			echo $ac_n "checking for pcre_info in -lpcre""... $ac_c" 1>&6
-echo "configure:2615: checking for pcre_info in -lpcre" >&5
+echo "configure:2617: checking for pcre_info in -lpcre" >&5
 ac_lib_var=`echo pcre'_'pcre_info | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2619,7 +2621,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lpcre  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2623 "configure"
+#line 2625 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2630,7 +2632,7 @@
 pcre_info()
 ; return 0; }
 EOF
-if { (eval echo configure:2634: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2636: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2666,12 +2668,12 @@
 fi
 
 echo $ac_n "checking for strcasecmp""... $ac_c" 1>&6
-echo "configure:2670: checking for strcasecmp" >&5
+echo "configure:2672: checking for strcasecmp" >&5
 if eval "test \"`echo '$''{'ac_cv_func_strcasecmp'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2675 "configure"
+#line 2677 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char strcasecmp(); below.  */
@@ -2694,7 +2696,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2698: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2700: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_strcasecmp=yes"
 else
@@ -2712,7 +2714,7 @@
 else
   echo "$ac_t""no" 1>&6
  echo $ac_n "checking for strcasecmp in -lresolv""... $ac_c" 1>&6
-echo "configure:2716: checking for strcasecmp in -lresolv" >&5
+echo "configure:2718: checking for strcasecmp in -lresolv" >&5
 ac_lib_var=`echo resolv'_'strcasecmp | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2720,7 +2722,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lresolv  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2724 "configure"
+#line 2726 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2731,7 +2733,7 @@
 strcasecmp()
 ; return 0; }
 EOF
-if { (eval echo configure:2735: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2737: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2755,12 +2757,12 @@
 fi
 
 echo $ac_n "checking for utimes""... $ac_c" 1>&6
-echo "configure:2759: checking for utimes" >&5
+echo "configure:2761: checking for utimes" >&5
 if eval "test \"`echo '$''{'ac_cv_func_utimes'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2764 "configure"
+#line 2766 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char utimes(); below.  */
@@ -2783,7 +2785,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2787: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2789: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_utimes=yes"
 else
@@ -2801,7 +2803,7 @@
 else
   echo "$ac_t""no" 1>&6
  echo $ac_n "checking for utimes in -lc89""... $ac_c" 1>&6
-echo "configure:2805: checking for utimes in -lc89" >&5
+echo "configure:2807: checking for utimes in -lc89" >&5
 ac_lib_var=`echo c89'_'utimes | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2809,7 +2811,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lc89  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2813 "configure"
+#line 2815 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2820,7 +2822,7 @@
 utimes()
 ; return 0; }
 EOF
-if { (eval echo configure:2824: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2826: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2845,12 +2847,12 @@
 
 
 echo $ac_n "checking for strftime""... $ac_c" 1>&6
-echo "configure:2849: checking for strftime" >&5
+echo "configure:2851: checking for strftime" >&5
 if eval "test \"`echo '$''{'ac_cv_func_strftime'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2854 "configure"
+#line 2856 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char strftime(); below.  */
@@ -2873,7 +2875,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2877: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2879: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_strftime=yes"
 else
@@ -2895,7 +2897,7 @@
   echo "$ac_t""no" 1>&6
 # strftime is in -lintl on SCO UNIX.
 echo $ac_n "checking for strftime in -lintl""... $ac_c" 1>&6
-echo "configure:2899: checking for strftime in -lintl" >&5
+echo "configure:2901: checking for strftime in -lintl" >&5
 ac_lib_var=`echo intl'_'strftime | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2903,7 +2905,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lintl  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 2907 "configure"
+#line 2909 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -2914,7 +2916,7 @@
 strftime()
 ; return 0; }
 EOF
-if { (eval echo configure:2918: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2920: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -2946,17 +2948,17 @@
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
-echo "configure:2950: checking for $ac_hdr" >&5
+echo "configure:2952: checking for $ac_hdr" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2955 "configure"
+#line 2957 "configure"
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:2960: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:2962: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -2985,9 +2987,9 @@
 
 # Check for ALTDIRFUNC glob() extension
 echo $ac_n "checking for GLOB_ALTDIRFUNC support""... $ac_c" 1>&6
-echo "configure:2989: checking for GLOB_ALTDIRFUNC support" >&5
+echo "configure:2991: checking for GLOB_ALTDIRFUNC support" >&5
 cat > conftest.$ac_ext <<EOF
-#line 2991 "configure"
+#line 2993 "configure"
 #include "confdefs.h"
 
 		#include <glob.h>
@@ -3018,9 +3020,9 @@
 
 # Check for g.gl_matchc glob() extension
 echo $ac_n "checking for gl_matchc field in glob_t""... $ac_c" 1>&6
-echo "configure:3022: checking for gl_matchc field in glob_t" >&5
+echo "configure:3024: checking for gl_matchc field in glob_t" >&5
 cat > conftest.$ac_ext <<EOF
-#line 3024 "configure"
+#line 3026 "configure"
 #include "confdefs.h"
 
                 #include <glob.h>
@@ -3048,12 +3050,12 @@
 
 
 echo $ac_n "checking whether struct dirent allocates space for d_name""... $ac_c" 1>&6
-echo "configure:3052: checking whether struct dirent allocates space for d_name" >&5
+echo "configure:3054: checking whether struct dirent allocates space for d_name" >&5
 if test "$cross_compiling" = yes; then
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 3057 "configure"
+#line 3059 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -3061,7 +3063,7 @@
 int main(void){struct dirent d;return(sizeof(d.d_name)<=sizeof(char));}
 	
 EOF
-if { (eval echo configure:3065: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:3067: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   echo "$ac_t""yes" 1>&6
 else
@@ -3102,12 +3104,12 @@
 			SKEY_MSG="yes" 
 	
 			echo $ac_n "checking for skey_keyinfo""... $ac_c" 1>&6
-echo "configure:3106: checking for skey_keyinfo" >&5
+echo "configure:3108: checking for skey_keyinfo" >&5
 if eval "test \"`echo '$''{'ac_cv_func_skey_keyinfo'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3111 "configure"
+#line 3113 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char skey_keyinfo(); below.  */
@@ -3130,7 +3132,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3134: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3136: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_skey_keyinfo=yes"
 else
@@ -3157,6 +3159,55 @@
 
 fi
 
+SECURID_MSG="no"
+# Check whether --with-securid or --without-securid was given.
+if test "${with_securid+set}" = set; then
+  withval="$with_securid"
+  
+		if test "x$withval" != "xno" ; then
+			saved_LIBS="$LIBS"
+			LIBS="$LIBS sdiclient.a"
+			echo $ac_n "checking for sdiclient.a""... $ac_c" 1>&6
+echo "configure:3172: checking for sdiclient.a" >&5
+			cat > conftest.$ac_ext <<EOF
+#line 3174 "configure"
+#include "confdefs.h"
+
+#include "sdi_athd.h"
+#include "sdconf.h"
+#include "sdacmvls.h"
+					struct SD_CLIENT sd_dat, *sd;
+					union config_record configure;
+				
+int main() {
+sd = &sd_dat; creadcfg(); sd_init(sd);
+; return 0; }
+EOF
+if { (eval echo configure:3187: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  
+					echo "$ac_t""yes" 1>&6
+					cat >> confdefs.h <<\EOF
+#define SECURID 1
+EOF
+
+					SECURID_MSG="yes" 
+				
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  
+					{ echo "configure: error: *** sdiclient.a missing" 1>&2; exit 1; }
+				
+			
+fi
+rm -f conftest*
+		fi
+	
+
+fi
+
 
 # Check whether user wants TCP wrappers support
 TCPW_MSG="no" 
@@ -3168,9 +3219,9 @@
 			saved_LIBS="$LIBS"
 			LIBS="-lwrap $LIBS"
 			echo $ac_n "checking for libwrap""... $ac_c" 1>&6
-echo "configure:3172: checking for libwrap" >&5
+echo "configure:3223: checking for libwrap" >&5
 			cat > conftest.$ac_ext <<EOF
-#line 3174 "configure"
+#line 3225 "configure"
 #include "confdefs.h"
 
 #include <tcpd.h>
@@ -3180,7 +3231,7 @@
 hosts_access(0);
 ; return 0; }
 EOF
-if { (eval echo configure:3184: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3235: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   
 					echo "$ac_t""yes" 1>&6
@@ -3209,12 +3260,12 @@
 for ac_func in arc4random atexit b64_ntop bcopy bindresvport_sa clock fchown fchmod freeaddrinfo futimes gai_strerror getcwd getaddrinfo getgrouplist getnameinfo getrlimit getrusage getttyent getusershell glob inet_aton inet_ntoa inet_ntop innetgr login_getcapbool md5_crypt memmove mkdtemp on_exit openpty realpath rresvport_af setdtablesize setenv setegid seteuid setlogin setproctitle setresgid setreuid setrlimit setsid setvbuf sigaction sigvec snprintf strerror strlcat strlcpy strmode strsep strtok_r sysconf tcgetpgrp utimes vsnprintf vhangup vis waitpid _getpty __b64_ntop
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3213: checking for $ac_func" >&5
+echo "configure:3264: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3218 "configure"
+#line 3269 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3237,7 +3288,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3241: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3292: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3264,12 +3315,12 @@
 for ac_func in gettimeofday time
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3268: checking for $ac_func" >&5
+echo "configure:3319: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3273 "configure"
+#line 3324 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3292,7 +3343,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3296: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3347: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3320,17 +3371,17 @@
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
-echo "configure:3324: checking for $ac_hdr" >&5
+echo "configure:3375: checking for $ac_hdr" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3329 "configure"
+#line 3380 "configure"
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:3334: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:3385: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -3359,12 +3410,12 @@
 for ac_func in login logout updwtmp logwtmp
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3363: checking for $ac_func" >&5
+echo "configure:3414: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3368 "configure"
+#line 3419 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3387,7 +3438,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3391: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3442: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3414,12 +3465,12 @@
 for ac_func in endutent getutent getutid getutline pututline setutent
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3418: checking for $ac_func" >&5
+echo "configure:3469: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3423 "configure"
+#line 3474 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3442,7 +3493,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3446: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3497: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3469,12 +3520,12 @@
 for ac_func in utmpname
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3473: checking for $ac_func" >&5
+echo "configure:3524: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3478 "configure"
+#line 3529 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3497,7 +3548,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3501: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3552: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3524,12 +3575,12 @@
 for ac_func in endutxent getutxent getutxid getutxline pututxline 
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3528: checking for $ac_func" >&5
+echo "configure:3579: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3533 "configure"
+#line 3584 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3552,7 +3603,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3556: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3607: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3579,12 +3630,12 @@
 for ac_func in setutxent utmpxname
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3583: checking for $ac_func" >&5
+echo "configure:3634: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3588 "configure"
+#line 3639 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3607,7 +3658,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3611: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3662: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -3633,12 +3684,12 @@
 
 
 echo $ac_n "checking for getuserattr""... $ac_c" 1>&6
-echo "configure:3637: checking for getuserattr" >&5
+echo "configure:3688: checking for getuserattr" >&5
 if eval "test \"`echo '$''{'ac_cv_func_getuserattr'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3642 "configure"
+#line 3693 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char getuserattr(); below.  */
@@ -3661,7 +3712,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3665: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3716: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_getuserattr=yes"
 else
@@ -3682,7 +3733,7 @@
 else
   echo "$ac_t""no" 1>&6
 echo $ac_n "checking for getuserattr in -ls""... $ac_c" 1>&6
-echo "configure:3686: checking for getuserattr in -ls" >&5
+echo "configure:3737: checking for getuserattr in -ls" >&5
 ac_lib_var=`echo s'_'getuserattr | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -3690,7 +3741,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-ls  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 3694 "configure"
+#line 3745 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -3701,7 +3752,7 @@
 getuserattr()
 ; return 0; }
 EOF
-if { (eval echo configure:3705: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3756: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -3729,12 +3780,12 @@
 
 
 echo $ac_n "checking for login""... $ac_c" 1>&6
-echo "configure:3733: checking for login" >&5
+echo "configure:3784: checking for login" >&5
 if eval "test \"`echo '$''{'ac_cv_func_login'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3738 "configure"
+#line 3789 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char login(); below.  */
@@ -3757,7 +3808,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3761: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3812: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_login=yes"
 else
@@ -3778,7 +3829,7 @@
 else
   echo "$ac_t""no" 1>&6
 echo $ac_n "checking for login in -lbsd""... $ac_c" 1>&6
-echo "configure:3782: checking for login in -lbsd" >&5
+echo "configure:3833: checking for login in -lbsd" >&5
 ac_lib_var=`echo bsd'_'login | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -3786,7 +3837,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lbsd  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 3790 "configure"
+#line 3841 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -3797,7 +3848,7 @@
 login()
 ; return 0; }
 EOF
-if { (eval echo configure:3801: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3852: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -3825,12 +3876,12 @@
 
 
 echo $ac_n "checking for daemon""... $ac_c" 1>&6
-echo "configure:3829: checking for daemon" >&5
+echo "configure:3880: checking for daemon" >&5
 if eval "test \"`echo '$''{'ac_cv_func_daemon'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3834 "configure"
+#line 3885 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char daemon(); below.  */
@@ -3853,7 +3904,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3857: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3908: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_daemon=yes"
 else
@@ -3874,7 +3925,7 @@
 else
   echo "$ac_t""no" 1>&6
 echo $ac_n "checking for daemon in -lbsd""... $ac_c" 1>&6
-echo "configure:3878: checking for daemon in -lbsd" >&5
+echo "configure:3929: checking for daemon in -lbsd" >&5
 ac_lib_var=`echo bsd'_'daemon | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -3882,7 +3933,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lbsd  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 3886 "configure"
+#line 3937 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -3893,7 +3944,7 @@
 daemon()
 ; return 0; }
 EOF
-if { (eval echo configure:3897: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3948: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -3921,12 +3972,12 @@
 
 
 echo $ac_n "checking for getpagesize""... $ac_c" 1>&6
-echo "configure:3925: checking for getpagesize" >&5
+echo "configure:3976: checking for getpagesize" >&5
 if eval "test \"`echo '$''{'ac_cv_func_getpagesize'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3930 "configure"
+#line 3981 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char getpagesize(); below.  */
@@ -3949,7 +4000,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3953: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4004: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_getpagesize=yes"
 else
@@ -3970,7 +4021,7 @@
 else
   echo "$ac_t""no" 1>&6
 echo $ac_n "checking for getpagesize in -lucb""... $ac_c" 1>&6
-echo "configure:3974: checking for getpagesize in -lucb" >&5
+echo "configure:4025: checking for getpagesize in -lucb" >&5
 ac_lib_var=`echo ucb'_'getpagesize | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -3978,7 +4029,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lucb  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 3982 "configure"
+#line 4033 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -3989,7 +4040,7 @@
 getpagesize()
 ; return 0; }
 EOF
-if { (eval echo configure:3993: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4044: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4019,19 +4070,19 @@
 # Check for broken snprintf
 if test "x$ac_cv_func_snprintf" = "xyes" ; then
 	echo $ac_n "checking whether snprintf correctly terminates long strings""... $ac_c" 1>&6
-echo "configure:4023: checking whether snprintf correctly terminates long strings" >&5
+echo "configure:4074: checking whether snprintf correctly terminates long strings" >&5
 	if test "$cross_compiling" = yes; then
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 4028 "configure"
+#line 4079 "configure"
 #include "confdefs.h"
 
 #include <stdio.h>
 int main(void){char b[5];snprintf(b,5,"123456789");return(b[4]!='\0');}
 		
 EOF
-if { (eval echo configure:4035: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4086: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   echo "$ac_t""yes" 1>&6
 else
@@ -4054,7 +4105,7 @@
 fi
 
 echo $ac_n "checking whether getpgrp takes no argument""... $ac_c" 1>&6
-echo "configure:4058: checking whether getpgrp takes no argument" >&5
+echo "configure:4109: checking whether getpgrp takes no argument" >&5
 if eval "test \"`echo '$''{'ac_cv_func_getpgrp_void'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4062,7 +4113,7 @@
   { echo "configure: error: cannot check getpgrp if cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 4066 "configure"
+#line 4117 "configure"
 #include "confdefs.h"
 
 /*
@@ -4117,7 +4168,7 @@
 }
 
 EOF
-if { (eval echo configure:4121: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4172: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_func_getpgrp_void=yes
 else
@@ -4153,7 +4204,7 @@
 			fi
 
 			echo $ac_n "checking for dlopen in -ldl""... $ac_c" 1>&6
-echo "configure:4157: checking for dlopen in -ldl" >&5
+echo "configure:4208: checking for dlopen in -ldl" >&5
 ac_lib_var=`echo dl'_'dlopen | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4161,7 +4212,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-ldl  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4165 "configure"
+#line 4216 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4172,7 +4223,7 @@
 dlopen()
 ; return 0; }
 EOF
-if { (eval echo configure:4176: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4227: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4200,7 +4251,7 @@
 fi
 
 			echo $ac_n "checking for pam_set_item in -lpam""... $ac_c" 1>&6
-echo "configure:4204: checking for pam_set_item in -lpam" >&5
+echo "configure:4255: checking for pam_set_item in -lpam" >&5
 ac_lib_var=`echo pam'_'pam_set_item | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4208,7 +4259,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lpam  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4212 "configure"
+#line 4263 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4219,7 +4270,7 @@
 pam_set_item()
 ; return 0; }
 EOF
-if { (eval echo configure:4223: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4274: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4250,12 +4301,12 @@
 			for ac_func in pam_getenvlist
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:4254: checking for $ac_func" >&5
+echo "configure:4305: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 4259 "configure"
+#line 4310 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -4278,7 +4329,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:4282: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4333: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -4320,9 +4371,9 @@
 if test "x$PAM_MSG" = "xyes" ; then
 	# Check PAM strerror arguments (old PAM)
 	echo $ac_n "checking whether pam_strerror takes only one argument""... $ac_c" 1>&6
-echo "configure:4324: checking whether pam_strerror takes only one argument" >&5
+echo "configure:4375: checking whether pam_strerror takes only one argument" >&5
 	cat > conftest.$ac_ext <<EOF
-#line 4326 "configure"
+#line 4377 "configure"
 #include "confdefs.h"
 
 #include <stdlib.h>
@@ -4332,7 +4383,7 @@
 (void)pam_strerror((pam_handle_t *)NULL, -1);
 ; return 0; }
 EOF
-if { (eval echo configure:4336: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:4387: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   echo "$ac_t""no" 1>&6
 else
@@ -4372,7 +4423,7 @@
 	tryssldir="$tryssldir $prefix"
 fi
 echo $ac_n "checking for OpenSSL directory""... $ac_c" 1>&6
-echo "configure:4376: checking for OpenSSL directory" >&5
+echo "configure:4427: checking for OpenSSL directory" >&5
 if eval "test \"`echo '$''{'ac_cv_openssldir'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4415,7 +4466,7 @@
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 4419 "configure"
+#line 4470 "configure"
 #include "confdefs.h"
 
 #include <string.h>
@@ -4429,7 +4480,7 @@
 }
 			
 EOF
-if { (eval echo configure:4433: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4484: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   
 				found_crypto=1
@@ -4498,7 +4549,7 @@
 # Now test RSA support
 saved_LIBS="$LIBS"
 echo $ac_n "checking for RSA support""... $ac_c" 1>&6
-echo "configure:4502: checking for RSA support" >&5
+echo "configure:4553: checking for RSA support" >&5
 for WANTS_RSAREF in "" 1 ; do
 	if test -z "$WANTS_RSAREF" ; then
 		LIBS="$saved_LIBS"
@@ -4509,7 +4560,7 @@
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 4513 "configure"
+#line 4564 "configure"
 #include "confdefs.h"
 
 #include <string.h>
@@ -4528,7 +4579,7 @@
 }
 	
 EOF
-if { (eval echo configure:4532: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4583: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   
 		rsa_works=1
@@ -4566,7 +4617,7 @@
 # version in OpenSSL. Skip this for PAM
 if test "x$PAM_MSG" = "xno" -a "x$check_for_libcrypt_later" = "x1"; then
 	echo $ac_n "checking for crypt in -lcrypt""... $ac_c" 1>&6
-echo "configure:4570: checking for crypt in -lcrypt" >&5
+echo "configure:4621: checking for crypt in -lcrypt" >&5
 ac_lib_var=`echo crypt'_'crypt | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4574,7 +4625,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lcrypt  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4578 "configure"
+#line 4629 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4585,7 +4636,7 @@
 crypt()
 ; return 0; }
 EOF
-if { (eval echo configure:4589: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4640: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4614,7 +4665,7 @@
 
 # Checks for data types
 echo $ac_n "checking size of char""... $ac_c" 1>&6
-echo "configure:4618: checking size of char" >&5
+echo "configure:4669: checking size of char" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_char'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4622,7 +4673,7 @@
   ac_cv_sizeof_char=1
 else
   cat > conftest.$ac_ext <<EOF
-#line 4626 "configure"
+#line 4677 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -4633,7 +4684,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:4637: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4688: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_char=`cat conftestval`
 else
@@ -4653,7 +4704,7 @@
 
 
 echo $ac_n "checking size of short int""... $ac_c" 1>&6
-echo "configure:4657: checking size of short int" >&5
+echo "configure:4708: checking size of short int" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_short_int'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4661,7 +4712,7 @@
   ac_cv_sizeof_short_int=2
 else
   cat > conftest.$ac_ext <<EOF
-#line 4665 "configure"
+#line 4716 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -4672,7 +4723,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:4676: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4727: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_short_int=`cat conftestval`
 else
@@ -4692,7 +4743,7 @@
 
 
 echo $ac_n "checking size of int""... $ac_c" 1>&6
-echo "configure:4696: checking size of int" >&5
+echo "configure:4747: checking size of int" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_int'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4700,7 +4751,7 @@
   ac_cv_sizeof_int=4
 else
   cat > conftest.$ac_ext <<EOF
-#line 4704 "configure"
+#line 4755 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -4711,7 +4762,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:4715: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4766: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_int=`cat conftestval`
 else
@@ -4731,7 +4782,7 @@
 
 
 echo $ac_n "checking size of long int""... $ac_c" 1>&6
-echo "configure:4735: checking size of long int" >&5
+echo "configure:4786: checking size of long int" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_long_int'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4739,7 +4790,7 @@
   ac_cv_sizeof_long_int=4
 else
   cat > conftest.$ac_ext <<EOF
-#line 4743 "configure"
+#line 4794 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -4750,7 +4801,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:4754: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4805: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_long_int=`cat conftestval`
 else
@@ -4770,7 +4821,7 @@
 
 
 echo $ac_n "checking size of long long int""... $ac_c" 1>&6
-echo "configure:4774: checking size of long long int" >&5
+echo "configure:4825: checking size of long long int" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_long_long_int'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -4778,7 +4829,7 @@
   ac_cv_sizeof_long_long_int=8
 else
   cat > conftest.$ac_ext <<EOF
-#line 4782 "configure"
+#line 4833 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -4789,7 +4840,7 @@
   exit(0);
 }
 EOF
-if { (eval echo configure:4793: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:4844: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_long_long_int=`cat conftestval`
 else
@@ -4811,20 +4862,20 @@
 
 # More checks for data types
 echo $ac_n "checking for u_int type""... $ac_c" 1>&6
-echo "configure:4815: checking for u_int type" >&5
+echo "configure:4866: checking for u_int type" >&5
 if eval "test \"`echo '$''{'ac_cv_have_u_int'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 4821 "configure"
+#line 4872 "configure"
 #include "confdefs.h"
  #include <sys/types.h> 
 int main() {
  u_int a; a = 1;
 ; return 0; }
 EOF
-if { (eval echo configure:4828: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:4879: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_u_int="yes" 
 else
@@ -4848,20 +4899,20 @@
 fi
 
 echo $ac_n "checking for intXX_t types""... $ac_c" 1>&6
-echo "configure:4852: checking for intXX_t types" >&5
+echo "configure:4903: checking for intXX_t types" >&5
 if eval "test \"`echo '$''{'ac_cv_have_intxx_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 4858 "configure"
+#line 4909 "configure"
 #include "confdefs.h"
  #include <sys/types.h> 
 int main() {
  int8_t a; int16_t b; int32_t c; a = b = c = 1;
 ; return 0; }
 EOF
-if { (eval echo configure:4865: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:4916: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_intxx_t="yes" 
 else
@@ -4885,20 +4936,20 @@
 fi
 	
 echo $ac_n "checking for int64_t type""... $ac_c" 1>&6
-echo "configure:4889: checking for int64_t type" >&5
+echo "configure:4940: checking for int64_t type" >&5
 if eval "test \"`echo '$''{'ac_cv_have_int64_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 4895 "configure"
+#line 4946 "configure"
 #include "confdefs.h"
  #include <sys/types.h> 
 int main() {
  int64_t a; a = 1;
 ; return 0; }
 EOF
-if { (eval echo configure:4902: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:4953: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_int64_t="yes" 
 else
@@ -4922,20 +4973,20 @@
 fi
 	
 echo $ac_n "checking for u_intXX_t types""... $ac_c" 1>&6
-echo "configure:4926: checking for u_intXX_t types" >&5
+echo "configure:4977: checking for u_intXX_t types" >&5
 if eval "test \"`echo '$''{'ac_cv_have_u_intxx_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 4932 "configure"
+#line 4983 "configure"
 #include "confdefs.h"
  #include <sys/types.h> 
 int main() {
  u_int8_t a; u_int16_t b; u_int32_t c; a = b = c = 1;
 ; return 0; }
 EOF
-if { (eval echo configure:4939: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:4990: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_u_intxx_t="yes" 
 else
@@ -4959,20 +5010,20 @@
 fi
 
 echo $ac_n "checking for u_int64_t types""... $ac_c" 1>&6
-echo "configure:4963: checking for u_int64_t types" >&5
+echo "configure:5014: checking for u_int64_t types" >&5
 if eval "test \"`echo '$''{'ac_cv_have_u_int64_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 4969 "configure"
+#line 5020 "configure"
 #include "confdefs.h"
  #include <sys/types.h> 
 int main() {
  u_int64_t a; a = 1;
 ; return 0; }
 EOF
-if { (eval echo configure:4976: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5027: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_u_int64_t="yes" 
 else
@@ -4999,9 +5050,9 @@
            test "x$ac_cv_header_sys_bitypes_h" = "xyes")
 then
 	echo $ac_n "checking for intXX_t and u_intXX_t types in sys/bitypes.h""... $ac_c" 1>&6
-echo "configure:5003: checking for intXX_t and u_intXX_t types in sys/bitypes.h" >&5
+echo "configure:5054: checking for intXX_t and u_intXX_t types in sys/bitypes.h" >&5
 	cat > conftest.$ac_ext <<EOF
-#line 5005 "configure"
+#line 5056 "configure"
 #include "confdefs.h"
 
 #include <sys/bitypes.h>
@@ -5014,7 +5065,7 @@
 		
 ; return 0; }
 EOF
-if { (eval echo configure:5018: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5069: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
 			cat >> confdefs.h <<\EOF
@@ -5039,13 +5090,13 @@
 
 if test -z "$have_u_intxx_t" ; then
 	echo $ac_n "checking for uintXX_t types""... $ac_c" 1>&6
-echo "configure:5043: checking for uintXX_t types" >&5
+echo "configure:5094: checking for uintXX_t types" >&5
 if eval "test \"`echo '$''{'ac_cv_have_uintxx_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5049 "configure"
+#line 5100 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5054,7 +5105,7 @@
  uint8_t a; uint16_t b; uint32_t c; a = b = c = 1; 
 ; return 0; }
 EOF
-if { (eval echo configure:5058: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5109: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_uintxx_t="yes" 
 else
@@ -5078,13 +5129,13 @@
 fi
 
 echo $ac_n "checking for socklen_t""... $ac_c" 1>&6
-echo "configure:5082: checking for socklen_t" >&5
+echo "configure:5133: checking for socklen_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_socklen_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5088 "configure"
+#line 5139 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5094,7 +5145,7 @@
 socklen_t foo; foo = 1235;
 ; return 0; }
 EOF
-if { (eval echo configure:5098: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5149: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_socklen_t="yes" 
 else
@@ -5117,13 +5168,13 @@
 fi
 
 echo $ac_n "checking for size_t""... $ac_c" 1>&6
-echo "configure:5121: checking for size_t" >&5
+echo "configure:5172: checking for size_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_size_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5127 "configure"
+#line 5178 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5132,7 +5183,7 @@
  size_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5136: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5187: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_size_t="yes" 
 else
@@ -5155,13 +5206,13 @@
 fi
 
 echo $ac_n "checking for ssize_t""... $ac_c" 1>&6
-echo "configure:5159: checking for ssize_t" >&5
+echo "configure:5210: checking for ssize_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_ssize_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5165 "configure"
+#line 5216 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5170,7 +5221,7 @@
  ssize_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5174: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5225: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_ssize_t="yes" 
 else
@@ -5193,13 +5244,13 @@
 fi
 
 echo $ac_n "checking for clock_t""... $ac_c" 1>&6
-echo "configure:5197: checking for clock_t" >&5
+echo "configure:5248: checking for clock_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_clock_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5203 "configure"
+#line 5254 "configure"
 #include "confdefs.h"
 
 #include <time.h>
@@ -5208,7 +5259,7 @@
  clock_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5212: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5263: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_clock_t="yes" 
 else
@@ -5231,13 +5282,13 @@
 fi
 
 echo $ac_n "checking for sa_family_t""... $ac_c" 1>&6
-echo "configure:5235: checking for sa_family_t" >&5
+echo "configure:5286: checking for sa_family_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_sa_family_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5241 "configure"
+#line 5292 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5247,7 +5298,7 @@
  sa_family_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5251: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5302: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_sa_family_t="yes" 
 else
@@ -5255,7 +5306,7 @@
   cat conftest.$ac_ext >&5
   rm -rf conftest*
    cat > conftest.$ac_ext <<EOF
-#line 5259 "configure"
+#line 5310 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5266,7 +5317,7 @@
  sa_family_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5270: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5321: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_sa_family_t="yes" 
 else
@@ -5292,13 +5343,13 @@
 fi
 
 echo $ac_n "checking for pid_t""... $ac_c" 1>&6
-echo "configure:5296: checking for pid_t" >&5
+echo "configure:5347: checking for pid_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_pid_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5302 "configure"
+#line 5353 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5307,7 +5358,7 @@
  pid_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5311: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5362: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_pid_t="yes" 
 else
@@ -5330,13 +5381,13 @@
 fi
 
 echo $ac_n "checking for mode_t""... $ac_c" 1>&6
-echo "configure:5334: checking for mode_t" >&5
+echo "configure:5385: checking for mode_t" >&5
 if eval "test \"`echo '$''{'ac_cv_have_mode_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5340 "configure"
+#line 5391 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5345,7 +5396,7 @@
  mode_t foo; foo = 1235; 
 ; return 0; }
 EOF
-if { (eval echo configure:5349: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5400: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_mode_t="yes" 
 else
@@ -5369,13 +5420,13 @@
 
 
 echo $ac_n "checking for struct sockaddr_storage""... $ac_c" 1>&6
-echo "configure:5373: checking for struct sockaddr_storage" >&5
+echo "configure:5424: checking for struct sockaddr_storage" >&5
 if eval "test \"`echo '$''{'ac_cv_have_struct_sockaddr_storage'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5379 "configure"
+#line 5430 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5385,7 +5436,7 @@
  struct sockaddr_storage s; 
 ; return 0; }
 EOF
-if { (eval echo configure:5389: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5440: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_struct_sockaddr_storage="yes" 
 else
@@ -5408,13 +5459,13 @@
 fi
 
 echo $ac_n "checking for struct sockaddr_in6""... $ac_c" 1>&6
-echo "configure:5412: checking for struct sockaddr_in6" >&5
+echo "configure:5463: checking for struct sockaddr_in6" >&5
 if eval "test \"`echo '$''{'ac_cv_have_struct_sockaddr_in6'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5418 "configure"
+#line 5469 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5424,7 +5475,7 @@
  struct sockaddr_in6 s; s.sin6_family = 0; 
 ; return 0; }
 EOF
-if { (eval echo configure:5428: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5479: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_struct_sockaddr_in6="yes" 
 else
@@ -5447,13 +5498,13 @@
 fi
 
 echo $ac_n "checking for struct in6_addr""... $ac_c" 1>&6
-echo "configure:5451: checking for struct in6_addr" >&5
+echo "configure:5502: checking for struct in6_addr" >&5
 if eval "test \"`echo '$''{'ac_cv_have_struct_in6_addr'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5457 "configure"
+#line 5508 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5463,7 +5514,7 @@
  struct in6_addr s; s.s6_addr[0] = 0; 
 ; return 0; }
 EOF
-if { (eval echo configure:5467: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5518: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_struct_in6_addr="yes" 
 else
@@ -5486,13 +5537,13 @@
 fi
 
 echo $ac_n "checking for struct addrinfo""... $ac_c" 1>&6
-echo "configure:5490: checking for struct addrinfo" >&5
+echo "configure:5541: checking for struct addrinfo" >&5
 if eval "test \"`echo '$''{'ac_cv_have_struct_addrinfo'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5496 "configure"
+#line 5547 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -5503,7 +5554,7 @@
  struct addrinfo s; s.ai_flags = AI_PASSIVE; 
 ; return 0; }
 EOF
-if { (eval echo configure:5507: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5558: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_struct_addrinfo="yes" 
 else
@@ -5526,20 +5577,20 @@
 fi
 
 echo $ac_n "checking for struct timeval""... $ac_c" 1>&6
-echo "configure:5530: checking for struct timeval" >&5
+echo "configure:5581: checking for struct timeval" >&5
 if eval "test \"`echo '$''{'ac_cv_have_struct_timeval'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 5536 "configure"
+#line 5587 "configure"
 #include "confdefs.h"
  #include <sys/time.h> 
 int main() {
  struct timeval tv; tv.tv_sec = 1;
 ; return 0; }
 EOF
-if { (eval echo configure:5543: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5594: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_struct_timeval="yes" 
 else
@@ -5573,7 +5624,7 @@
     { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
 else
   cat > conftest.$ac_ext <<EOF
-#line 5577 "configure"
+#line 5628 "configure"
 #include "confdefs.h"
 
 #include <stdio.h>
@@ -5600,7 +5651,7 @@
 #endif
 		
 EOF
-if { (eval echo configure:5604: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:5655: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
    true 
 else
@@ -5624,13 +5675,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_host
 	echo $ac_n "checking for ut_host field in utmp.h""... $ac_c" 1>&6
-echo "configure:5628: checking for ut_host field in utmp.h" >&5
+echo "configure:5679: checking for ut_host field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5634 "configure"
+#line 5685 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -5664,13 +5715,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_host
 	echo $ac_n "checking for ut_host field in utmpx.h""... $ac_c" 1>&6
-echo "configure:5668: checking for ut_host field in utmpx.h" >&5
+echo "configure:5719: checking for ut_host field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5674 "configure"
+#line 5725 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -5704,13 +5755,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"syslen
 	echo $ac_n "checking for syslen field in utmpx.h""... $ac_c" 1>&6
-echo "configure:5708: checking for syslen field in utmpx.h" >&5
+echo "configure:5759: checking for syslen field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5714 "configure"
+#line 5765 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -5744,13 +5795,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_pid
 	echo $ac_n "checking for ut_pid field in utmp.h""... $ac_c" 1>&6
-echo "configure:5748: checking for ut_pid field in utmp.h" >&5
+echo "configure:5799: checking for ut_pid field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5754 "configure"
+#line 5805 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -5784,13 +5835,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_type
 	echo $ac_n "checking for ut_type field in utmp.h""... $ac_c" 1>&6
-echo "configure:5788: checking for ut_type field in utmp.h" >&5
+echo "configure:5839: checking for ut_type field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5794 "configure"
+#line 5845 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -5824,13 +5875,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_type
 	echo $ac_n "checking for ut_type field in utmpx.h""... $ac_c" 1>&6
-echo "configure:5828: checking for ut_type field in utmpx.h" >&5
+echo "configure:5879: checking for ut_type field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5834 "configure"
+#line 5885 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -5864,13 +5915,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_tv
 	echo $ac_n "checking for ut_tv field in utmp.h""... $ac_c" 1>&6
-echo "configure:5868: checking for ut_tv field in utmp.h" >&5
+echo "configure:5919: checking for ut_tv field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5874 "configure"
+#line 5925 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -5904,13 +5955,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_id
 	echo $ac_n "checking for ut_id field in utmp.h""... $ac_c" 1>&6
-echo "configure:5908: checking for ut_id field in utmp.h" >&5
+echo "configure:5959: checking for ut_id field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5914 "configure"
+#line 5965 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -5944,13 +5995,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_id
 	echo $ac_n "checking for ut_id field in utmpx.h""... $ac_c" 1>&6
-echo "configure:5948: checking for ut_id field in utmpx.h" >&5
+echo "configure:5999: checking for ut_id field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5954 "configure"
+#line 6005 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -5984,13 +6035,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_addr
 	echo $ac_n "checking for ut_addr field in utmp.h""... $ac_c" 1>&6
-echo "configure:5988: checking for ut_addr field in utmp.h" >&5
+echo "configure:6039: checking for ut_addr field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 5994 "configure"
+#line 6045 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -6024,13 +6075,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_addr
 	echo $ac_n "checking for ut_addr field in utmpx.h""... $ac_c" 1>&6
-echo "configure:6028: checking for ut_addr field in utmpx.h" >&5
+echo "configure:6079: checking for ut_addr field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6034 "configure"
+#line 6085 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -6064,13 +6115,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_addr_v6
 	echo $ac_n "checking for ut_addr_v6 field in utmp.h""... $ac_c" 1>&6
-echo "configure:6068: checking for ut_addr_v6 field in utmp.h" >&5
+echo "configure:6119: checking for ut_addr_v6 field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6074 "configure"
+#line 6125 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -6104,13 +6155,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_addr_v6
 	echo $ac_n "checking for ut_addr_v6 field in utmpx.h""... $ac_c" 1>&6
-echo "configure:6108: checking for ut_addr_v6 field in utmpx.h" >&5
+echo "configure:6159: checking for ut_addr_v6 field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6114 "configure"
+#line 6165 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -6144,13 +6195,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_exit
 	echo $ac_n "checking for ut_exit field in utmp.h""... $ac_c" 1>&6
-echo "configure:6148: checking for ut_exit field in utmp.h" >&5
+echo "configure:6199: checking for ut_exit field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6154 "configure"
+#line 6205 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -6184,13 +6235,13 @@
 		ossh_safe=`echo "utmp.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_time
 	echo $ac_n "checking for ut_time field in utmp.h""... $ac_c" 1>&6
-echo "configure:6188: checking for ut_time field in utmp.h" >&5
+echo "configure:6239: checking for ut_time field in utmp.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6194 "configure"
+#line 6245 "configure"
 #include "confdefs.h"
 #include <utmp.h>
 EOF
@@ -6224,13 +6275,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_time
 	echo $ac_n "checking for ut_time field in utmpx.h""... $ac_c" 1>&6
-echo "configure:6228: checking for ut_time field in utmpx.h" >&5
+echo "configure:6279: checking for ut_time field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6234 "configure"
+#line 6285 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -6264,13 +6315,13 @@
 		ossh_safe=`echo "utmpx.h" | sed 'y%./+-%__p_%'`
 		ossh_varname="ossh_cv_$ossh_safe""_has_"ut_tv
 	echo $ac_n "checking for ut_tv field in utmpx.h""... $ac_c" 1>&6
-echo "configure:6268: checking for ut_tv field in utmpx.h" >&5
+echo "configure:6319: checking for ut_tv field in utmpx.h" >&5
 	if eval "test \"`echo '$''{'$ossh_varname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 		cat > conftest.$ac_ext <<EOF
-#line 6274 "configure"
+#line 6325 "configure"
 #include "confdefs.h"
 #include <utmpx.h>
 EOF
@@ -6300,12 +6351,12 @@
 	fi
 
 echo $ac_n "checking for st_blksize in struct stat""... $ac_c" 1>&6
-echo "configure:6304: checking for st_blksize in struct stat" >&5
+echo "configure:6355: checking for st_blksize in struct stat" >&5
 if eval "test \"`echo '$''{'ac_cv_struct_st_blksize'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 6309 "configure"
+#line 6360 "configure"
 #include "confdefs.h"
 #include <sys/types.h>
 #include <sys/stat.h>
@@ -6313,7 +6364,7 @@
 struct stat s; s.st_blksize;
 ; return 0; }
 EOF
-if { (eval echo configure:6317: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:6368: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   ac_cv_struct_st_blksize=yes
 else
@@ -6335,13 +6386,13 @@
 
 
 echo $ac_n "checking for sun_len field in struct sockaddr_un""... $ac_c" 1>&6
-echo "configure:6339: checking for sun_len field in struct sockaddr_un" >&5
+echo "configure:6390: checking for sun_len field in struct sockaddr_un" >&5
 if eval "test \"`echo '$''{'ac_cv_have_sun_len_in_struct_sockaddr_un'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6345 "configure"
+#line 6396 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -6351,7 +6402,7 @@
  struct sockaddr_un s; s.sun_len = 1; 
 ; return 0; }
 EOF
-if { (eval echo configure:6355: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:6406: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_sun_len_in_struct_sockaddr_un="yes" 
 else
@@ -6373,13 +6424,13 @@
 fi
 
 echo $ac_n "checking for ss_family field in struct sockaddr_storage""... $ac_c" 1>&6
-echo "configure:6377: checking for ss_family field in struct sockaddr_storage" >&5
+echo "configure:6428: checking for ss_family field in struct sockaddr_storage" >&5
 if eval "test \"`echo '$''{'ac_cv_have_ss_family_in_struct_ss'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6383 "configure"
+#line 6434 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -6389,7 +6440,7 @@
  struct sockaddr_storage s; s.ss_family = 1; 
 ; return 0; }
 EOF
-if { (eval echo configure:6393: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:6444: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_ss_family_in_struct_ss="yes" 
 else
@@ -6411,13 +6462,13 @@
 fi
 
 echo $ac_n "checking for __ss_family field in struct sockaddr_storage""... $ac_c" 1>&6
-echo "configure:6415: checking for __ss_family field in struct sockaddr_storage" >&5
+echo "configure:6466: checking for __ss_family field in struct sockaddr_storage" >&5
 if eval "test \"`echo '$''{'ac_cv_have___ss_family_in_struct_ss'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6421 "configure"
+#line 6472 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -6427,7 +6478,7 @@
  struct sockaddr_storage s; s.__ss_family = 1; 
 ; return 0; }
 EOF
-if { (eval echo configure:6431: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:6482: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have___ss_family_in_struct_ss="yes" 
 else
@@ -6450,13 +6501,13 @@
 fi
 
 echo $ac_n "checking for pw_class field in struct passwd""... $ac_c" 1>&6
-echo "configure:6454: checking for pw_class field in struct passwd" >&5
+echo "configure:6505: checking for pw_class field in struct passwd" >&5
 if eval "test \"`echo '$''{'ac_cv_have_pw_class_in_struct_passwd'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6460 "configure"
+#line 6511 "configure"
 #include "confdefs.h"
 
 #include <pwd.h>
@@ -6465,7 +6516,7 @@
  struct passwd p; p.pw_class = 0; 
 ; return 0; }
 EOF
-if { (eval echo configure:6469: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:6520: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    ac_cv_have_pw_class_in_struct_passwd="yes" 
 else
@@ -6489,20 +6540,20 @@
 
 
 echo $ac_n "checking if libc defines __progname""... $ac_c" 1>&6
-echo "configure:6493: checking if libc defines __progname" >&5
+echo "configure:6544: checking if libc defines __progname" >&5
 if eval "test \"`echo '$''{'ac_cv_libc_defines___progname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6499 "configure"
+#line 6550 "configure"
 #include "confdefs.h"
 
 int main() {
  extern char *__progname; printf("%s", __progname); 
 ; return 0; }
 EOF
-if { (eval echo configure:6506: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6557: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
    ac_cv_libc_defines___progname="yes" 
 else
@@ -6526,20 +6577,20 @@
 
 
 echo $ac_n "checking if libc defines sys_errlist""... $ac_c" 1>&6
-echo "configure:6530: checking if libc defines sys_errlist" >&5
+echo "configure:6581: checking if libc defines sys_errlist" >&5
 if eval "test \"`echo '$''{'ac_cv_libc_defines_sys_errlist'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6536 "configure"
+#line 6587 "configure"
 #include "confdefs.h"
 
 int main() {
  extern const char *const sys_errlist[]; printf("%s", sys_errlist[0]);
 ; return 0; }
 EOF
-if { (eval echo configure:6543: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6594: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
    ac_cv_libc_defines_sys_errlist="yes" 
 else
@@ -6563,20 +6614,20 @@
 
 
 echo $ac_n "checking if libc defines sys_nerr""... $ac_c" 1>&6
-echo "configure:6567: checking if libc defines sys_nerr" >&5
+echo "configure:6618: checking if libc defines sys_nerr" >&5
 if eval "test \"`echo '$''{'ac_cv_libc_defines_sys_nerr'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
 	cat > conftest.$ac_ext <<EOF
-#line 6573 "configure"
+#line 6624 "configure"
 #include "confdefs.h"
 
 int main() {
  extern int sys_nerr; printf("%i", sys_nerr);
 ; return 0; }
 EOF
-if { (eval echo configure:6580: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6631: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
    ac_cv_libc_defines_sys_nerr="yes" 
 else
@@ -6626,17 +6677,17 @@
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
-echo "configure:6630: checking for $ac_hdr" >&5
+echo "configure:6681: checking for $ac_hdr" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 6635 "configure"
+#line 6686 "configure"
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:6640: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:6691: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -6666,7 +6717,7 @@
 				echo "configure: warning: Cannot find krb.h, build may fail" 1>&2
 			fi
 			echo $ac_n "checking for main in -lkrb""... $ac_c" 1>&6
-echo "configure:6670: checking for main in -lkrb" >&5
+echo "configure:6721: checking for main in -lkrb" >&5
 ac_lib_var=`echo krb'_'main | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -6674,14 +6725,14 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lkrb  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 6678 "configure"
+#line 6729 "configure"
 #include "confdefs.h"
 
 int main() {
 main()
 ; return 0; }
 EOF
-if { (eval echo configure:6685: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6736: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -6710,7 +6761,7 @@
 
 			if test "$ac_cv_lib_krb_main" != yes; then
 				echo $ac_n "checking for main in -lkrb4""... $ac_c" 1>&6
-echo "configure:6714: checking for main in -lkrb4" >&5
+echo "configure:6765: checking for main in -lkrb4" >&5
 ac_lib_var=`echo krb4'_'main | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -6718,14 +6769,14 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lkrb4  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 6722 "configure"
+#line 6773 "configure"
 #include "confdefs.h"
 
 int main() {
 main()
 ; return 0; }
 EOF
-if { (eval echo configure:6729: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6780: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -6761,7 +6812,7 @@
 				KLIBS="-lkrb"
 			fi
 			echo $ac_n "checking for des_cbc_encrypt in -ldes""... $ac_c" 1>&6
-echo "configure:6765: checking for des_cbc_encrypt in -ldes" >&5
+echo "configure:6816: checking for des_cbc_encrypt in -ldes" >&5
 ac_lib_var=`echo des'_'des_cbc_encrypt | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -6769,7 +6820,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-ldes  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 6773 "configure"
+#line 6824 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -6780,7 +6831,7 @@
 des_cbc_encrypt()
 ; return 0; }
 EOF
-if { (eval echo configure:6784: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6835: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -6809,7 +6860,7 @@
 
 			if test "$ac_cv_lib_des_des_cbc_encrypt" != yes; then
 				echo $ac_n "checking for des_cbc_encrypt in -ldes425""... $ac_c" 1>&6
-echo "configure:6813: checking for des_cbc_encrypt in -ldes425" >&5
+echo "configure:6864: checking for des_cbc_encrypt in -ldes425" >&5
 ac_lib_var=`echo des425'_'des_cbc_encrypt | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -6817,7 +6868,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-ldes425  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 6821 "configure"
+#line 6872 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -6828,7 +6879,7 @@
 des_cbc_encrypt()
 ; return 0; }
 EOF
-if { (eval echo configure:6832: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6883: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -6864,7 +6915,7 @@
 				KLIBS="-ldes"
 			fi
 			echo $ac_n "checking for dn_expand in -lresolv""... $ac_c" 1>&6
-echo "configure:6868: checking for dn_expand in -lresolv" >&5
+echo "configure:6919: checking for dn_expand in -lresolv" >&5
 ac_lib_var=`echo resolv'_'dn_expand | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -6872,7 +6923,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lresolv  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 6876 "configure"
+#line 6927 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -6883,7 +6934,7 @@
 dn_expand()
 ; return 0; }
 EOF
-if { (eval echo configure:6887: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:6938: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -6969,7 +7020,7 @@
 		# Extract the first word of "rsh", so it can be a program name with args.
 set dummy rsh; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:6973: checking for $ac_word" >&5
+echo "configure:7024: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_rsh_path'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7019,7 +7070,7 @@
 		# Extract the first word of "xauth", so it can be a program name with args.
 set dummy xauth; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7023: checking for $ac_word" >&5
+echo "configure:7074: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_xauth_path'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7090,7 +7141,7 @@
 	
 ac_safe=`echo ""/dev/ptmx"" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for "/dev/ptmx"""... $ac_c" 1>&6
-echo "configure:7094: checking for "/dev/ptmx"" >&5
+echo "configure:7145: checking for "/dev/ptmx"" >&5
 if eval "test \"`echo '$''{'ac_cv_file_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7123,7 +7174,7 @@
 
 ac_safe=`echo ""/dev/ptc"" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for "/dev/ptc"""... $ac_c" 1>&6
-echo "configure:7127: checking for "/dev/ptc"" >&5
+echo "configure:7178: checking for "/dev/ptc"" >&5
 if eval "test \"`echo '$''{'ac_cv_file_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7174,7 +7225,7 @@
 		
 ac_safe=`echo ""/dev/urandom"" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for "/dev/urandom"""... $ac_c" 1>&6
-echo "configure:7178: checking for "/dev/urandom"" >&5
+echo "configure:7229: checking for "/dev/urandom"" >&5
 if eval "test \"`echo '$''{'ac_cv_file_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7244,7 +7295,7 @@
 		# Check for existing socket only if we don't have a random device already
 		if test -z "$RANDOM_POOL" ; then
 			echo $ac_n "checking for PRNGD/EGD socket""... $ac_c" 1>&6
-echo "configure:7248: checking for PRNGD/EGD socket" >&5
+echo "configure:7299: checking for PRNGD/EGD socket" >&5
 			# Insert other locations here
 			for sock in /var/run/egd-pool /dev/egd-pool /etc/entropy; do
 				if test -r $sock && $TEST_MINUS_S_SH -c "test -S $sock -o -p $sock" ; then
@@ -7277,7 +7328,7 @@
 	# Extract the first word of "ls", so it can be a program name with args.
 set dummy ls; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7281: checking for $ac_word" >&5
+echo "configure:7332: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_LS'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7318,7 +7369,7 @@
 	# Extract the first word of "netstat", so it can be a program name with args.
 set dummy netstat; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7322: checking for $ac_word" >&5
+echo "configure:7373: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_NETSTAT'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7359,7 +7410,7 @@
 	# Extract the first word of "arp", so it can be a program name with args.
 set dummy arp; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7363: checking for $ac_word" >&5
+echo "configure:7414: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_ARP'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7400,7 +7451,7 @@
 	# Extract the first word of "ifconfig", so it can be a program name with args.
 set dummy ifconfig; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7404: checking for $ac_word" >&5
+echo "configure:7455: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_IFCONFIG'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7441,7 +7492,7 @@
 	# Extract the first word of "ps", so it can be a program name with args.
 set dummy ps; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7445: checking for $ac_word" >&5
+echo "configure:7496: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_PS'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7482,7 +7533,7 @@
 	# Extract the first word of "w", so it can be a program name with args.
 set dummy w; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7486: checking for $ac_word" >&5
+echo "configure:7537: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_W'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7523,7 +7574,7 @@
 	# Extract the first word of "who", so it can be a program name with args.
 set dummy who; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7527: checking for $ac_word" >&5
+echo "configure:7578: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_WHO'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7564,7 +7615,7 @@
 	# Extract the first word of "last", so it can be a program name with args.
 set dummy last; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7568: checking for $ac_word" >&5
+echo "configure:7619: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_LAST'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7605,7 +7656,7 @@
 	# Extract the first word of "lastlog", so it can be a program name with args.
 set dummy lastlog; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7609: checking for $ac_word" >&5
+echo "configure:7660: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_LASTLOG'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7646,7 +7697,7 @@
 	# Extract the first word of "df", so it can be a program name with args.
 set dummy df; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7650: checking for $ac_word" >&5
+echo "configure:7701: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_DF'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7687,7 +7738,7 @@
 	# Extract the first word of "vmstat", so it can be a program name with args.
 set dummy vmstat; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7691: checking for $ac_word" >&5
+echo "configure:7742: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_VMSTAT'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7728,7 +7779,7 @@
 	# Extract the first word of "uptime", so it can be a program name with args.
 set dummy uptime; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7732: checking for $ac_word" >&5
+echo "configure:7783: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_UPTIME'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7769,7 +7820,7 @@
 	# Extract the first word of "ipcs", so it can be a program name with args.
 set dummy ipcs; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7773: checking for $ac_word" >&5
+echo "configure:7824: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_IPCS'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7810,7 +7861,7 @@
 	# Extract the first word of "tail", so it can be a program name with args.
 set dummy tail; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7814: checking for $ac_word" >&5
+echo "configure:7865: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_PROG_TAIL'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7875,7 +7926,7 @@
 # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:7879: checking for $ac_word" >&5
+echo "configure:7930: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_NROFF'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -7964,9 +8015,9 @@
 
 if test -z "$disable_shadow" ; then
 	echo $ac_n "checking if the systems has expire shadow information""... $ac_c" 1>&6
-echo "configure:7968: checking if the systems has expire shadow information" >&5
+echo "configure:8019: checking if the systems has expire shadow information" >&5
 	cat > conftest.$ac_ext <<EOF
-#line 7970 "configure"
+#line 8021 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -7977,7 +8028,7 @@
  sp.sp_expire = sp.sp_lstchg = sp.sp_inact = 0; 
 ; return 0; }
 EOF
-if { (eval echo configure:7981: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8032: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    sp_expire_available=yes 
 else
@@ -8044,7 +8095,7 @@
 	
 else
   cat > conftest.$ac_ext <<EOF
-#line 8048 "configure"
+#line 8099 "configure"
 #include "confdefs.h"
 
 /* find out what STDPATH is */
@@ -8076,7 +8127,7 @@
 }
 		
 EOF
-if { (eval echo configure:8080: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:8131: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
    user_path=`cat conftest.stdpath` 
 else
@@ -8133,7 +8184,7 @@
 
 
 echo $ac_n "checking if we need to convert IPv4 in IPv6-mapped addresses""... $ac_c" 1>&6
-echo "configure:8137: checking if we need to convert IPv4 in IPv6-mapped addresses" >&5
+echo "configure:8188: checking if we need to convert IPv4 in IPv6-mapped addresses" >&5
 IPV4_IN6_HACK_MSG="no" 
 # Check whether --with-4in6 or --without-4in6 was given.
 if test "${with_4in6+set}" = set; then
@@ -8185,7 +8236,7 @@
 
 
 echo $ac_n "checking whether to install ssh as suid root""... $ac_c" 1>&6
-echo "configure:8189: checking whether to install ssh as suid root" >&5
+echo "configure:8240: checking whether to install ssh as suid root" >&5
 # Check whether --enable-suid-ssh or --disable-suid-ssh was given.
 if test "${enable_suid_ssh+set}" = set; then
   enableval="$enable_suid_ssh"
@@ -8334,9 +8385,9 @@
 
 
 echo $ac_n "checking if your system defines LASTLOG_FILE""... $ac_c" 1>&6
-echo "configure:8338: checking if your system defines LASTLOG_FILE" >&5
+echo "configure:8389: checking if your system defines LASTLOG_FILE" >&5
 cat > conftest.$ac_ext <<EOF
-#line 8340 "configure"
+#line 8391 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -8352,7 +8403,7 @@
  char *lastlog = LASTLOG_FILE; 
 ; return 0; }
 EOF
-if { (eval echo configure:8356: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8407: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    echo "$ac_t""yes" 1>&6 
 else
@@ -8362,9 +8413,9 @@
   
 		echo "$ac_t""no" 1>&6
 		echo $ac_n "checking if your system defines _PATH_LASTLOG""... $ac_c" 1>&6
-echo "configure:8366: checking if your system defines _PATH_LASTLOG" >&5
+echo "configure:8417: checking if your system defines _PATH_LASTLOG" >&5
 		cat > conftest.$ac_ext <<EOF
-#line 8368 "configure"
+#line 8419 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -8380,7 +8431,7 @@
  char *lastlog = _PATH_LASTLOG; 
 ; return 0; }
 EOF
-if { (eval echo configure:8384: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8435: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    echo "$ac_t""yes" 1>&6 
 else
@@ -8419,9 +8470,9 @@
 fi	
 
 echo $ac_n "checking if your system defines UTMP_FILE""... $ac_c" 1>&6
-echo "configure:8423: checking if your system defines UTMP_FILE" >&5
+echo "configure:8474: checking if your system defines UTMP_FILE" >&5
 cat > conftest.$ac_ext <<EOF
-#line 8425 "configure"
+#line 8476 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -8434,7 +8485,7 @@
  char *utmp = UTMP_FILE; 
 ; return 0; }
 EOF
-if { (eval echo configure:8438: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8489: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    echo "$ac_t""yes" 1>&6 
 else
@@ -8469,9 +8520,9 @@
 fi	
 
 echo $ac_n "checking if your system defines WTMP_FILE""... $ac_c" 1>&6
-echo "configure:8473: checking if your system defines WTMP_FILE" >&5
+echo "configure:8524: checking if your system defines WTMP_FILE" >&5
 cat > conftest.$ac_ext <<EOF
-#line 8475 "configure"
+#line 8526 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -8484,7 +8535,7 @@
  char *wtmp = WTMP_FILE; 
 ; return 0; }
 EOF
-if { (eval echo configure:8488: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8539: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    echo "$ac_t""yes" 1>&6 
 else
@@ -8520,9 +8571,9 @@
 
 
 echo $ac_n "checking if your system defines UTMPX_FILE""... $ac_c" 1>&6
-echo "configure:8524: checking if your system defines UTMPX_FILE" >&5
+echo "configure:8575: checking if your system defines UTMPX_FILE" >&5
 cat > conftest.$ac_ext <<EOF
-#line 8526 "configure"
+#line 8577 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -8538,7 +8589,7 @@
  char *utmpx = UTMPX_FILE; 
 ; return 0; }
 EOF
-if { (eval echo configure:8542: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8593: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    echo "$ac_t""yes" 1>&6 
 else
@@ -8565,9 +8616,9 @@
 fi	
 
 echo $ac_n "checking if your system defines WTMPX_FILE""... $ac_c" 1>&6
-echo "configure:8569: checking if your system defines WTMPX_FILE" >&5
+echo "configure:8620: checking if your system defines WTMPX_FILE" >&5
 cat > conftest.$ac_ext <<EOF
-#line 8571 "configure"
+#line 8622 "configure"
 #include "confdefs.h"
 
 #include <sys/types.h>
@@ -8583,7 +8634,7 @@
  char *wtmpx = WTMPX_FILE; 
 ; return 0; }
 EOF
-if { (eval echo configure:8587: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8638: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
    echo "$ac_t""yes" 1>&6 
 else
@@ -8635,12 +8686,12 @@
 fi
 
 echo $ac_n "checking for Cygwin environment""... $ac_c" 1>&6
-echo "configure:8639: checking for Cygwin environment" >&5
+echo "configure:8690: checking for Cygwin environment" >&5
 if eval "test \"`echo '$''{'ac_cv_cygwin'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 8644 "configure"
+#line 8695 "configure"
 #include "confdefs.h"
 
 int main() {
@@ -8651,7 +8702,7 @@
 return __CYGWIN__;
 ; return 0; }
 EOF
-if { (eval echo configure:8655: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8706: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   ac_cv_cygwin=yes
 else
@@ -8668,19 +8719,19 @@
 CYGWIN=
 test "$ac_cv_cygwin" = yes && CYGWIN=yes
 echo $ac_n "checking for mingw32 environment""... $ac_c" 1>&6
-echo "configure:8672: checking for mingw32 environment" >&5
+echo "configure:8723: checking for mingw32 environment" >&5
 if eval "test \"`echo '$''{'ac_cv_mingw32'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 8677 "configure"
+#line 8728 "configure"
 #include "confdefs.h"
 
 int main() {
 return __MINGW32__;
 ; return 0; }
 EOF
-if { (eval echo configure:8684: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:8735: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   ac_cv_mingw32=yes
 else
@@ -8699,7 +8750,7 @@
 
 
 echo $ac_n "checking for executable suffix""... $ac_c" 1>&6
-echo "configure:8703: checking for executable suffix" >&5
+echo "configure:8754: checking for executable suffix" >&5
 if eval "test \"`echo '$''{'ac_cv_exeext'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -8709,7 +8760,7 @@
   rm -f conftest*
   echo 'int main () { return 0; }' > conftest.$ac_ext
   ac_cv_exeext=
-  if { (eval echo configure:8713: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; }; then
+  if { (eval echo configure:8764: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; }; then
     for file in conftest.*; do
       case $file in
       *.c | *.o | *.obj) ;;
@@ -9168,6 +9219,7 @@
 echo "            KerberosIV support: $KRB4_MSG"
 echo "                   AFS support: $AFS_MSG"
 echo "                 S/KEY support: $SKEY_MSG"
+echo "               SecurID support: $SECURID_MSG"
 echo "          TCP Wrappers support: $TCPW_MSG"
 echo "          MD5 password support: $MD5_MSG"
 echo "   IP address in \$DISPLAY hack: $DISPLAY_HACK_MSG"
diff -ruN openssh-2.9p2.orig/configure.in openssh-2.9p2/configure.in
--- openssh-2.9p2.orig/configure.in	Mon May 28 13:21:44 2001
+++ openssh-2.9p2/configure.in	Thu Jun 28 13:03:55 2001
@@ -429,6 +429,35 @@
 		fi
 	]
 )
+SECURID_MSG="no"
+AC_ARG_WITH(securid,
+	[  --with-securid          Enable SecurID support],
+	[
+		if test "x$withval" != "xno" ; then
+			saved_LIBS="$LIBS"
+			LIBS="$LIBS sdiclient.a"
+			AC_MSG_CHECKING(for sdiclient.a)
+			AC_TRY_LINK(
+				[
+#include "sdi_athd.h"
+#include "sdconf.h"
+#include "sdacmvls.h"
+					struct SD_CLIENT sd_dat, *sd;
+					union config_record configure;
+				],
+				[sd = &sd_dat; creadcfg(); sd_init(sd);],
+				[
+					AC_MSG_RESULT(yes)
+					AC_DEFINE(SECURID)
+					SECURID_MSG="yes" 
+				],
+				[
+					AC_MSG_ERROR([*** sdiclient.a missing])
+				]
+			)
+		fi
+	]
+)
 
 # Check whether user wants TCP wrappers support
 TCPW_MSG="no" 
@@ -1935,6 +1964,7 @@
 echo "            KerberosIV support: $KRB4_MSG"
 echo "                   AFS support: $AFS_MSG"
 echo "                 S/KEY support: $SKEY_MSG"
+echo "               SecurID support: $SECURID_MSG"
 echo "          TCP Wrappers support: $TCPW_MSG"
 echo "          MD5 password support: $MD5_MSG"
 echo "   IP address in \$DISPLAY hack: $DISPLAY_HACK_MSG"
diff -ruN openssh-2.9p2.orig/readconf.c openssh-2.9p2/readconf.c
--- openssh-2.9p2.orig/readconf.c	Tue Apr 17 14:11:37 2001
+++ openssh-2.9p2/readconf.c	Thu Jun 28 13:03:55 2001
@@ -95,6 +95,8 @@
 	oBadOption,
 	oForwardAgent, oForwardX11, oGatewayPorts, oRhostsAuthentication,
 	oPasswordAuthentication, oRSAAuthentication, oFallBackToRsh, oUseRsh,
+	oSecurIDAuthentication, oSecurIDFallBack,
+	oAllowNonSecurID, oSecurIDUsersFile, oSecurIDIgnoreShell,
 	oChallengeResponseAuthentication, oXAuthLocation,
 #ifdef KRB4
 	oKerberosAuthentication,
@@ -126,6 +128,11 @@
 	{ "gatewayports", oGatewayPorts },
 	{ "useprivilegedport", oUsePrivilegedPort },
 	{ "rhostsauthentication", oRhostsAuthentication },
+	{ "securidauthentication", oSecurIDAuthentication },
+	{ "securidfallback", oSecurIDFallBack },
+	{ "allownonsecurid", oAllowNonSecurID },
+	{ "securidusersfile", oSecurIDUsersFile },
+	{ "securidignoreshell", oSecurIDIgnoreShell },
 	{ "passwordauthentication", oPasswordAuthentication },
 	{ "kbdinteractiveauthentication", oKbdInteractiveAuthentication },
 	{ "kbdinteractivedevices", oKbdInteractiveDevices },
@@ -322,6 +329,21 @@
 	case oRSAAuthentication:
 		intptr = &options->rsa_authentication;
 		goto parse_flag;
+	case oSecurIDAuthentication:
+		intptr = &options->securid_authentication;
+		goto parse_flag;
+	case oSecurIDFallBack:
+		intptr = &options->securid_fallback;
+		goto parse_flag;
+	case oAllowNonSecurID:
+		intptr = &options->allow_nonsecurid;
+		goto parse_flag;
+	case oSecurIDUsersFile:
+		charptr=&options->securid_usersfile;
+		goto parse_string;
+	case oSecurIDIgnoreShell:
+		intptr = &options->securid_ignore_shell;
+		goto parse_flag;
 
 	case oRhostsRSAAuthentication:
 		intptr = &options->rhosts_rsa_authentication;
@@ -719,6 +741,11 @@
 	options->rsa_authentication = -1;
 	options->pubkey_authentication = -1;
 	options->challenge_reponse_authentication = -1;
+	options->securid_authentication = -1;
+	options->securid_fallback = -1;
+	options->allow_nonsecurid = -1;
+	options->securid_usersfile = NULL;
+	options->securid_ignore_shell = -1;
 #ifdef KRB4
 	options->kerberos_authentication = -1;
 #endif
@@ -773,6 +800,14 @@
 {
 	int len;
 
+	if (options->securid_authentication == -1)
+		options->securid_authentication = 1;
+	if (options->securid_fallback == -1)
+		options->securid_fallback = 0;
+	if (options->allow_nonsecurid == -1)
+		options->allow_nonsecurid = 1;
+	if (options->securid_ignore_shell == -1)
+		options->securid_ignore_shell = 0;
 	if (options->forward_agent == -1)
 		options->forward_agent = 0;
 	if (options->forward_x11 == -1)
diff -ruN openssh-2.9p2.orig/readconf.h openssh-2.9p2/readconf.h
--- openssh-2.9p2.orig/readconf.h	Tue Apr 17 14:11:37 2001
+++ openssh-2.9p2/readconf.h	Thu Jun 28 13:03:55 2001
@@ -40,6 +40,11 @@
 	int     pubkey_authentication;	/* Try ssh2 pubkey authentication. */
 	int     hostbased_authentication;	/* ssh2's rhosts_rsa */
 	int     challenge_reponse_authentication;
+	int     securid_authentication;	/* Try SecurID authentication. */
+	int     securid_fallback;	/* Allow fall back to normal password */
+	int     allow_nonsecurid;	/* Allow non securid users logins */
+	char   *securid_usersfile;	/* SecurID auth users in this file */
+	int	securid_ignore_shell;   /* Ignore ACE propsed shell? */
 					/* Try S/Key or TIS, authentication. */
 #ifdef KRB4
 	int     kerberos_authentication;	/* Try Kerberos
diff -ruN openssh-2.9p2.orig/servconf.c openssh-2.9p2/servconf.c
--- openssh-2.9p2.orig/servconf.c	Wed Apr 25 08:44:15 2001
+++ openssh-2.9p2/servconf.c	Thu Jun 28 13:03:55 2001
@@ -70,6 +70,13 @@
 	options->hostbased_uses_name_from_packet_only = -1;
 	options->rsa_authentication = -1;
 	options->pubkey_authentication = -1;
+#ifdef SECURID
+	options->securid_authentication = -1;
+	options->securid_fallback = -1;
+	options->allow_nonsecurid = -1;
+	options->securid_usersfile = NULL;
+	options->securid_ignore_shell = -1;
+#endif
 #ifdef KRB4
 	options->kerberos_authentication = -1;
 	options->kerberos_or_local_passwd = -1;
@@ -168,6 +175,16 @@
 		options->rsa_authentication = 1;
 	if (options->pubkey_authentication == -1)
 		options->pubkey_authentication = 1;
+#ifdef SECURID
+	if (options->securid_authentication == -1)
+		options->securid_authentication = 1;
+	if (options->securid_fallback == -1)
+		options->securid_fallback = 0;
+	if (options->allow_nonsecurid == -1)
+		options->securid_fallback = 1;
+	if (options->securid_ignore_shell == -1)
+		options->securid_ignore_shell = 0;
+#endif
 #ifdef KRB4
 	if (options->kerberos_authentication == -1)
 		options->kerberos_authentication = (access(KEYFILE, R_OK) == 0);
@@ -218,6 +235,10 @@
 	sPort, sHostKeyFile, sServerKeyBits, sLoginGraceTime, sKeyRegenerationTime,
 	sPermitRootLogin, sLogFacility, sLogLevel,
 	sRhostsAuthentication, sRhostsRSAAuthentication, sRSAAuthentication,
+#ifdef SECURID
+	sSecurIDAuthentication, sSecurIDFallBack, sAllowNonSecurID,
+	sSecurIDUsersFile, sSecurIDIgnoreShell,
+#endif
 #ifdef KRB4
 	sKerberosAuthentication, sKerberosOrLocalPasswd, sKerberosTicketCleanup,
 #endif
@@ -252,6 +273,13 @@
 	{ "keyregenerationinterval", sKeyRegenerationTime },
 	{ "permitrootlogin", sPermitRootLogin },
 	{ "syslogfacility", sLogFacility },
+#ifdef SECURID
+	{ "securidauthentication", sSecurIDAuthentication },
+	{ "securidfallback", sSecurIDFallBack },
+	{ "allownonsecurid", sAllowNonSecurID },
+	{ "securidusersfile", sSecurIDUsersFile },
+	{ "securidignoreshell", sSecurIDIgnoreShell },
+#endif
 	{ "loglevel", sLogLevel },
 	{ "rhostsauthentication", sRhostsAuthentication },
 	{ "rhostsrsaauthentication", sRhostsRSAAuthentication },
@@ -577,6 +605,23 @@
 
 		case sKerberosTicketCleanup:
 			intptr = &options->kerberos_ticket_cleanup;
+			goto parse_flag;
+#endif
+#ifdef SECURID
+		case sSecurIDAuthentication:
+			intptr = &options->securid_authentication;
+			goto parse_flag;
+		case sSecurIDFallBack:
+			intptr = &options->securid_fallback;
+			goto parse_flag;
+		case sAllowNonSecurID:
+			intptr = &options->allow_nonsecurid;
+			goto parse_flag;
+		case sSecurIDUsersFile:
+			charptr = &options->securid_usersfile;
+			goto parse_filename;
+		case sSecurIDIgnoreShell:
+			intptr = &options->securid_ignore_shell;
 			goto parse_flag;
 #endif
 
diff -ruN openssh-2.9p2.orig/servconf.h openssh-2.9p2/servconf.h
--- openssh-2.9p2.orig/servconf.h	Wed Apr 25 08:44:16 2001
+++ openssh-2.9p2/servconf.h	Thu Jun 28 13:03:55 2001
@@ -84,6 +84,19 @@
 	int     kerberos_ticket_cleanup;	/* If true, destroy ticket
 						 * file on logout. */
 #endif
+#ifdef SECURID
+	int     securid_authentication; /* If set, use securid */
+	int	securid_fallback;	/* If set, allow normal passwords
+					   is master/slave are not accessible */
+	int	allow_nonsecurid;	/* If set, allow nonsecurid users
+					   logins via other means (e.g. PAM) */
+	char   *securid_usersfile;	/* If set, only users in the file
+					   will authenticate via SecurID
+					   The shell need not be .../sdshell */
+	int	securid_ignore_shell;	/* If true, use the shell in /etc/passwd
+					   instead of the shell proposed by
+					   the ACE server. */
+#endif
 #ifdef AFS
 	int     kerberos_tgt_passing;	/* If true, permit Kerberos tgt
 					 * passing. */
diff -ruN openssh-2.9p2.orig/sshd.0 openssh-2.9p2/sshd.0
--- openssh-2.9p2.orig/sshd.0	Sun Jun 17 00:10:05 2001
+++ openssh-2.9p2/sshd.0	Thu Jun 28 13:03:55 2001
@@ -186,6 +186,16 @@
              Only group names are valid; a numerical group ID isn't recogM--
              nized.  By default login is allowed regardless of the group list.
 
+     AllowNonSecurID
+             This will allow users that do not meet the SecurID login activaM--
+             tion requirements (not in the SecurIDUsersFile or do not have a
+             shell ending with sdshell, if the SecurIDUsersFile option is used
+             or is omitted, respectively) to still log in using another auM--
+             thentication method (e.g. PAM or passwd.)
+
+
+
+
      AllowTcpForwarding
              Specifies whether TCP forwarding is permitted.  The default is
              ``yes''. Note that disabling TCP forwarding does not improve seM--
@@ -315,6 +325,8 @@
              is yes, the password provided by the user will be validated
              through the Kerberos KDC.  To use this option, the server needs a
              Kerberos servtab which allows the verification of the KDC's idenM--
+
+
              tity.  Default is ``yes''.
 
      KerberosOrLocalPasswd
@@ -325,8 +337,6 @@
      KerberosTgtPassing
              Specifies whether a Kerberos TGT may be forwarded to the server.
              Default is ``no'', as this only works when the Kerberos KDC is
-
-
              actually an AFS kaserver.
 
      KerberosTicketCleanup
@@ -393,7 +403,6 @@
              lowed. This allows the use of most PAM challenge response authenM--
              tication modules, but it will allow password authentication reM--
              gardless of whether PasswordAuthentication is disabled.  The deM--
-
              fault is ``no''.
 
      PasswordAuthentication
@@ -523,8 +532,6 @@
            1.   If the login is on a tty, and no command has been specified,
                 prints last login time and /etc/motd (unless prevented in the
                 configuration file or by $HOME/.hushlogin; see the FILES secM--
-
-
                 tion).
 
            2.   If the login is on a tty, records login time.
@@ -650,6 +657,7 @@
      Each line in these files contains the following fields: hostnames, bits,
      exponent, modulus, comment.  The fields are separated by spaces.
 
+
      Hostnames is a comma-separated list of patterns ('*' and '?' act as wildM--
      cards); each pattern in turn is matched against the canonical host name
      (when authenticating a client) or against the user-supplied name (when
@@ -657,7 +665,6 @@
      cate negation: if the host name matches a negated pattern, it is not acM--
      cepted (by that line) even if it matched another pattern on the line.
 
-
      Bits, exponent, and modulus are taken directly from the RSA host key;
      they can be obtained, e.g., from /etc/ssh_host_key.pub. The optional comM--
      ment field continues to the end of the line, and is not used.
@@ -853,7 +860,6 @@
 SEE ALSO
      scp(1),  sftp(1),  sftp-server(8),  ssh(1),  ssh-add(1),  ssh-agent(1),
      ssh-keygen(1),  rlogin(1),  rsh(1)
-
 
      T. Ylonen, T. Kivinen, M. Saarinen, T. Rinne, and S. Lehtinen, SSH
      Protocol Architecture, draft-ietf-secsh-architecture-07.txt, January
diff -ruN openssh-2.9p2.orig/sshd.8 openssh-2.9p2/sshd.8
--- openssh-2.9p2.orig/sshd.8	Wed Apr 25 08:44:16 2001
+++ openssh-2.9p2/sshd.8	Thu Jun 28 13:03:55 2001
@@ -310,6 +310,13 @@
 Only group names are valid; a numerical group ID isn't recognized.
 By default login is allowed regardless of the group list.
 .Pp
+.It Cm AllowNonSecurID
+This will allow users that do not meet the SecurID login 
+activation requirements (not in the SecurIDUsersFile or do not 
+have a shell ending with sdshell, if the SecurIDUsersFile option
+is used or is omitted, respectively) to still log in using another
+authentication method (e.g. PAM or passwd.)
+.Pp
 .It Cm AllowTcpForwarding
 Specifies whether TCP forwarding is permitted.
 The default is
